
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Classification Examples &#8212; Ex-Fuzzy 1.0.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=edfbbfd1" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=30646c52"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/classification';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Reference" href="../api/index.html" />
    <link rel="prev" title="Examples" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.0.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs..."
         aria-label="Search the docs..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo-light.png" class="logo__image only-light" alt=""/>
    <img src="../_static/logo-dark.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">Ex-Fuzzy</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting-started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/fuzzy_sets.html">
    Fuzzy Sets
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/classifiers.html">
    Classifiers Module
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/evolutionary_fit.html">
    Evolutionary Fit Module
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../api/eval_tools.html">
    Evaluation Tools Module
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../contributing.html">
    Contributing
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../changelog.html">
    Changelog
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../roadmap.html">
    Roadmap
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../usage.html">
    Getting Started
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../step1.html">
    Creating fuzzy sets and fuzzy variables
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../step2.html">
    Using Fuzzy Rules
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../step3.html">
    Optimizing a Fuzzy rule base for a classification problem
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../step4.html">
    Visualize rules and results
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../precom.html">
    Computing fuzzy partitions
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../optimize.html">
    Genetic algorithm details
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../gt2.html">
    General Type 2
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../tmpfs.html">
    Temporal Fuzzy Sets
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../extending.html">
    Extending Ex-Fuzzy
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../persistence.html">
    Persistence
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../classifiers.html">
    Advanced classifiers
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../pattern_stats.html">
    Bootstrapping and rule robustness
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/fuminides/ex-fuzzy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/ex-fuzzy/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../getting-started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/fuzzy_sets.html">
    Fuzzy Sets
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/classifiers.html">
    Classifiers Module
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/evolutionary_fit.html">
    Evolutionary Fit Module
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/eval_tools.html">
    Evaluation Tools Module
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../changelog.html">
    Changelog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../roadmap.html">
    Roadmap
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../usage.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../step1.html">
    Creating fuzzy sets and fuzzy variables
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../step2.html">
    Using Fuzzy Rules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../step3.html">
    Optimizing a Fuzzy rule base for a classification problem
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../step4.html">
    Visualize rules and results
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../precom.html">
    Computing fuzzy partitions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../optimize.html">
    Genetic algorithm details
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../gt2.html">
    General Type 2
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../tmpfs.html">
    Temporal Fuzzy Sets
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../extending.html">
    Extending Ex-Fuzzy
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../persistence.html">
    Persistence
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../classifiers.html">
    Advanced classifiers
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../pattern_stats.html">
    Bootstrapping and rule robustness
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/fuminides/ex-fuzzy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/ex-fuzzy/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Classification Examples</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Classification Examples</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="classification-examples">
<h1>Classification Examples<a class="headerlink" href="#classification-examples" title="Link to this heading">#</a></h1>
<p>This section provides comprehensive examples of using ex-fuzzy for classification tasks, from basic usage to advanced techniques.</p>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#basic-classification" id="id1">Basic Classification</a></p>
<ul>
<li><p><a class="reference internal" href="#iris-classification" id="id2">Iris Classification</a></p></li>
<li><p><a class="reference internal" href="#alternative-classifiers" id="id3">Alternative Classifiers</a></p></li>
<li><p><a class="reference internal" href="#multi-class-classification" id="id4">Multi-Class Classification</a></p></li>
<li><p><a class="reference internal" href="#example-output" id="id5">Example Output</a></p></li>
<li><p><a class="reference internal" href="#working-with-different-fuzzy-set-types" id="id6">Working with Different Fuzzy Set Types</a></p></li>
<li><p><a class="reference internal" href="#direct-use-of-basefuzzyrulesclassifier" id="id7">Direct Use of BaseFuzzyRulesClassifier</a></p></li>
<li><p><a class="reference internal" href="#available-evaluation-tools" id="id8">Available Evaluation Tools</a></p></li>
<li><p><a class="reference internal" href="#customer-segmentation" id="id9">Customer Segmentation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#model-interpretation-and-analysis" id="id10">Model Interpretation and Analysis</a></p>
<ul>
<li><p><a class="reference internal" href="#rule-analysis" id="id11">Rule Analysis</a></p></li>
<li><p><a class="reference internal" href="#feature-importance" id="id12">Feature Importance</a></p></li>
<li><p><a class="reference internal" href="#prediction-explanation" id="id13">Prediction Explanation</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#cross-validation-and-robustness" id="id14">Cross-Validation and Robustness</a></p>
<ul>
<li><p><a class="reference internal" href="#robust-evaluation" id="id15">Robust Evaluation</a></p></li>
<li><p><a class="reference internal" href="#model-comparison" id="id16">Model Comparison</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#performance-optimization" id="id17">Performance Optimization</a></p>
<ul>
<li><p><a class="reference internal" href="#efficient-training" id="id18">Efficient Training</a></p></li>
<li><p><a class="reference internal" href="#memory-efficient-processing" id="id19">Memory-Efficient Processing</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#best-practices-summary" id="id20">Best Practices Summary</a></p></li>
<li><p><a class="reference internal" href="#next-steps" id="id21">Next Steps</a></p></li>
</ul>
</nav>
<section id="basic-classification">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Basic Classification</a><a class="headerlink" href="#basic-classification" title="Link to this heading">#</a></h2>
<section id="iris-classification">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">Iris Classification</a><a class="headerlink" href="#iris-classification" title="Link to this heading">#</a></h3>
<p>A complete walkthrough using the classic Iris dataset:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">classification_report</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">accuracy_score</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">ex_fuzzy.fuzzy_sets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fs</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ex_fuzzy.classifiers</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">clf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ex_fuzzy.utils</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">utils</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ex_fuzzy.eval_tools</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">eval_tools</span>

<span class="c1"># Load the Iris dataset</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>
<span class="n">feature_names</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span>
<span class="n">class_names</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target_names</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dataset shape: </span><span class="si">{</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Classes: </span><span class="si">{</span><span class="n">class_names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Features: </span><span class="si">{</span><span class="n">feature_names</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Split the data</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span>
<span class="p">)</span>

<span class="c1"># Compute linguistic variables (fuzzy partitions) for each feature</span>
<span class="n">precomputed_partitions</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">construct_partitions</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">)</span>

<span class="c1"># Create and train the rule-mining fuzzy classifier</span>
<span class="n">classifier</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">RuleMineClassifier</span><span class="p">(</span>
    <span class="n">nRules</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>                                    <span class="c1"># Number of rules to optimize</span>
    <span class="n">nAnts</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>                                      <span class="c1"># Maximum antecedents per rule</span>
    <span class="n">fuzzy_type</span><span class="o">=</span><span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>                 <span class="c1"># Type-1 fuzzy sets</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>                              <span class="c1"># Tolerance for rule dominance</span>
    <span class="n">linguistic_variables</span><span class="o">=</span><span class="n">precomputed_partitions</span>  <span class="c1"># Precomputed fuzzy partitions</span>
<span class="p">)</span>

<span class="c1"># Fit the classifier with genetic algorithm parameters</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training fuzzy classifier...&quot;</span><span class="p">)</span>
<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">n_gen</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pop_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Make predictions</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Evaluate performance</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">nTest Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Detailed evaluation</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">nClassification Report:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">class_names</span><span class="p">))</span>

<span class="c1"># Confusion matrix</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">nConfusion Matrix:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">class_names</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">class_names</span><span class="p">))</span>
</pre></div>
</div>
<p>Expected output:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span> Dataset shape: (150, 4)
 Classes: [&#39;setosa&#39; &#39;versicolor&#39; &#39;virginica&#39;]
 Features: [&#39;sepal length (cm)&#39;, &#39;sepal width (cm)&#39;, &#39;petal length (cm)&#39;, &#39;petal width (cm)&#39;]

 Training fuzzy classifier...
 Test Accuracy: 0.956

 Classification Report:
              precision    recall  f1-score   support
      setosa       1.00      1.00      1.00        15
  versicolor       0.93      0.93      0.93        15
   virginica       0.93      0.93      0.93        15

    accuracy                           0.96        45
   macro avg       0.95      0.95      0.95        45
weighted avg       0.96      0.96      0.96        45
</pre></div>
</div>
<p>Custom Fuzzy Variables
Advanced Usage
~~~~~~~~~~~~~</p>
<p>Using the comprehensive evaluation function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use the comprehensive evaluation function</span>
<span class="n">evaluation_report</span> <span class="o">=</span> <span class="n">eval_tools</span><span class="o">.</span><span class="n">eval_fuzzy_model</span><span class="p">(</span>
    <span class="n">classifier</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span>
    <span class="n">plot_rules</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>           <span class="c1"># Generate rule plots</span>
    <span class="n">print_rules</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>          <span class="c1"># Print rule text</span>
    <span class="n">plot_partitions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>      <span class="c1"># Plot fuzzy partitions</span>
    <span class="n">return_rules</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>         <span class="c1"># Return rule text</span>
    <span class="n">bootstrap_results_print</span><span class="o">=</span><span class="kc">True</span>  <span class="c1"># Statistical analysis</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">evaluation_report</span><span class="p">)</span>

<span class="c1"># Or use the FuzzyEvaluator class directly for more control</span>
<span class="n">evaluator</span> <span class="o">=</span> <span class="n">eval_tools</span><span class="o">.</span><span class="n">FuzzyEvaluator</span><span class="p">(</span><span class="n">classifier</span><span class="p">)</span>

<span class="c1"># Get specific metrics</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span><span class="s1">&#39;accuracy_score&#39;</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
<span class="n">f1_score</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span><span class="s1">&#39;f1_score&#39;</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">)</span>
<span class="n">precision</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span><span class="s1">&#39;precision_score&#39;</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">)</span>
<span class="n">recall</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span><span class="s1">&#39;recall_score&#39;</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1-Score: </span><span class="si">{</span><span class="n">f1_score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision: </span><span class="si">{</span><span class="n">precision</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall: </span><span class="si">{</span><span class="n">recall</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="alternative-classifiers">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Alternative Classifiers</a><a class="headerlink" href="#alternative-classifiers" title="Link to this heading">#</a></h3>
<p>Ex-fuzzy provides multiple classifier options:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Two-stage classifier with rule mining and optimization</span>
<span class="n">fuzzy_classifier</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">FuzzyRulesClassifier</span><span class="p">(</span>
    <span class="n">nRules</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">nAnts</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">fuzzy_type</span><span class="o">=</span><span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">linguistic_variables</span><span class="o">=</span><span class="n">precomputed_partitions</span>
<span class="p">)</span>
<span class="n">fuzzy_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">n_gen</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">pop_size</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>

<span class="c1"># Rule fine-tuning classifier</span>
<span class="n">fine_tune_classifier</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">RuleFineTuneClassifier</span><span class="p">(</span>
    <span class="n">nRules</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">nAnts</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">fuzzy_type</span><span class="o">=</span><span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
    <span class="n">linguistic_variables</span><span class="o">=</span><span class="n">precomputed_partitions</span>
<span class="p">)</span>
<span class="n">fine_tune_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">n_gen</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pop_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># Strategy 2: SMOTE + Fuzzy classifier</span>
<span class="n">smote</span> <span class="o">=</span> <span class="n">SMOTE</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_train_smote</span><span class="p">,</span> <span class="n">y_train_smote</span> <span class="o">=</span> <span class="n">smote</span><span class="o">.</span><span class="n">fit_resample</span><span class="p">(</span><span class="n">X_train_imb</span><span class="p">,</span> <span class="n">y_train_imb</span><span class="p">)</span>

<span class="n">smote_classifier</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">RuleMineClassifier</span><span class="p">(</span>
    <span class="n">nRules</span><span class="o">=</span><span class="mi">25</span><span class="p">,</span>
    <span class="n">nAnts</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="n">smote_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_smote</span><span class="p">,</span> <span class="n">y_train_smote</span><span class="p">)</span>
<span class="n">smote_score</span> <span class="o">=</span> <span class="n">smote_classifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_imb</span><span class="p">,</span> <span class="n">y_test_imb</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Weighted classifier accuracy: </span><span class="si">{</span><span class="n">weighted_score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SMOTE + Fuzzy accuracy: </span><span class="si">{</span><span class="n">smote_score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Compare with balanced accuracy</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">balanced_accuracy_score</span>

<span class="n">weighted_balanced</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span>
    <span class="n">y_test_imb</span><span class="p">,</span> <span class="n">weighted_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_imb</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">smote_balanced</span> <span class="o">=</span> <span class="n">balanced_accuracy_score</span><span class="p">(</span>
    <span class="n">y_test_imb</span><span class="p">,</span> <span class="n">smote_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_imb</span><span class="p">)</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Weighted balanced accuracy: </span><span class="si">{</span><span class="n">weighted_balanced</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SMOTE balanced accuracy: </span><span class="si">{</span><span class="n">smote_balanced</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="multi-class-classification">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Multi-Class Classification</a><a class="headerlink" href="#multi-class-classification" title="Link to this heading">#</a></h3>
<p>Working with datasets having many classes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_digits</span>

<span class="c1"># Load digits dataset (10 classes)</span>
<span class="n">digits</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="example-output">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Example Output</a><a class="headerlink" href="#example-output" title="Link to this heading">#</a></h3>
<p>Expected performance on the Iris dataset:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Training fuzzy classifier...
------------
ACCURACY
Train performance: 0.943
Test performance: 0.956
------------
MATTHEW CORRCOEF
Train performance: 0.914
Test performance: 0.933
------------

Rule 1: IF petal length (cm) is low AND petal width (cm) is low THEN setosa
Rule 2: IF petal length (cm) is medium AND petal width (cm) is medium THEN versicolor
Rule 3: IF petal length (cm) is high AND petal width (cm) is high THEN virginica
...
</pre></div>
</div>
</section>
<section id="working-with-different-fuzzy-set-types">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Working with Different Fuzzy Set Types</a><a class="headerlink" href="#working-with-different-fuzzy-set-types" title="Link to this heading">#</a></h3>
<p>Ex-fuzzy supports different types of fuzzy sets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Type-1 fuzzy sets (default)</span>
<span class="n">classifier_t1</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">RuleMineClassifier</span><span class="p">(</span>
    <span class="n">nRules</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">nAnts</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">fuzzy_type</span><span class="o">=</span><span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>  <span class="c1"># Type-1 fuzzy sets</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span>
<span class="p">)</span>

<span class="c1"># Type-2 fuzzy sets</span>
<span class="n">classifier_t2</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">RuleMineClassifier</span><span class="p">(</span>
    <span class="n">nRules</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">nAnts</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">fuzzy_type</span><span class="o">=</span><span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span><span class="p">,</span>  <span class="c1"># Type-2 fuzzy sets</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span>
<span class="p">)</span>

<span class="c1"># General Type-2 fuzzy sets</span>
<span class="n">classifier_gt2</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">RuleMineClassifier</span><span class="p">(</span>
    <span class="n">nRules</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">nAnts</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">fuzzy_type</span><span class="o">=</span><span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">gt2</span><span class="p">,</span>  <span class="c1"># General Type-2 fuzzy sets</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="direct-use-of-basefuzzyrulesclassifier">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Direct Use of BaseFuzzyRulesClassifier</a><a class="headerlink" href="#direct-use-of-basefuzzyrulesclassifier" title="Link to this heading">#</a></h3>
<p>For more direct control, you can use the underlying classifier:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">ex_fuzzy.evolutionary_fit</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">evf</span>

<span class="c1"># Create linguistic variables manually</span>
<span class="n">precomputed_partitions</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">construct_partitions</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">)</span>

<span class="c1"># Create the base classifier directly</span>
<span class="n">base_classifier</span> <span class="o">=</span> <span class="n">evf</span><span class="o">.</span><span class="n">BaseFuzzyRulesClassifier</span><span class="p">(</span>
    <span class="n">nRules</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
    <span class="n">linguistic_variables</span><span class="o">=</span><span class="n">precomputed_partitions</span><span class="p">,</span>
    <span class="n">nAnts</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">n_linguistic_variables</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">fuzzy_type</span><span class="o">=</span><span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span>
<span class="p">)</span>

<span class="c1"># Fit with genetic algorithm parameters</span>
<span class="n">base_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">n_gen</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">pop_size</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># Evaluate</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">base_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Base classifier accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Print and visualize rules</span>
<span class="n">rule_text</span> <span class="o">=</span> <span class="n">base_classifier</span><span class="o">.</span><span class="n">print_rules</span><span class="p">(</span><span class="n">return_rules</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rule_text</span><span class="p">)</span>

<span class="c1"># Plot fuzzy variables</span>
<span class="n">base_classifier</span><span class="o">.</span><span class="n">plot_fuzzy_variables</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="available-evaluation-tools">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Available Evaluation Tools</a><a class="headerlink" href="#available-evaluation-tools" title="Link to this heading">#</a></h3>
<p>Ex-fuzzy provides comprehensive evaluation capabilities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create evaluator</span>
<span class="n">evaluator</span> <span class="o">=</span> <span class="n">eval_tools</span><span class="o">.</span><span class="n">FuzzyEvaluator</span><span class="p">(</span><span class="n">classifier</span><span class="p">)</span>

<span class="c1"># Get individual metrics</span>
<span class="n">metrics_to_compute</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;accuracy_score&#39;</span><span class="p">,</span>
    <span class="s1">&#39;precision_score&#39;</span><span class="p">,</span>
    <span class="s1">&#39;recall_score&#39;</span><span class="p">,</span>
    <span class="s1">&#39;f1_score&#39;</span><span class="p">,</span>
    <span class="s1">&#39;matthews_corrcoef&#39;</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">metrics_to_compute</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">metric</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;precision_score&#39;</span><span class="p">,</span> <span class="s1">&#39;recall_score&#39;</span><span class="p">,</span> <span class="s1">&#39;f1_score&#39;</span><span class="p">]:</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;weighted&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">get_metric</span><span class="p">(</span><span class="n">metric</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IF age is elderly AND cholesterol is high THEN high_risk&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IF blood_pressure is high AND heart_rate is low THEN high_risk&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;IF age is young AND cholesterol is normal THEN low_risk&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="customer-segmentation">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Customer Segmentation</a><a class="headerlink" href="#customer-segmentation" title="Link to this heading">#</a></h3>
<p>Business application for customer classification:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_customer_data</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create synthetic customer dataset.&quot;&quot;&quot;</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">n_customers</span> <span class="o">=</span> <span class="mi">1000</span>

    <span class="c1"># Customer features</span>
    <span class="n">age</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="n">n_customers</span><span class="p">)</span>
    <span class="n">income</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">lognormal</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">n_customers</span><span class="p">)</span>
    <span class="n">spending_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">n_customers</span><span class="p">)</span>
    <span class="n">tenure</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">exponential</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">n_customers</span><span class="p">)</span>

    <span class="c1"># Create customer segments based on business logic</span>
    <span class="n">segments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_customers</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">income</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">75000</span> <span class="ow">and</span> <span class="n">spending_score</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>
            <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Premium</span>
        <span class="k">elif</span> <span class="n">income</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">50000</span> <span class="ow">and</span> <span class="n">spending_score</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">40</span><span class="p">:</span>
            <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Standard</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">segments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Basic</span>

    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">age</span><span class="p">,</span> <span class="n">income</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">spending_score</span><span class="p">,</span> <span class="n">tenure</span><span class="p">])</span>  <span class="c1"># Scale income</span>
    <span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;income_k&#39;</span><span class="p">,</span> <span class="s1">&#39;spending_score&#39;</span><span class="p">,</span> <span class="s1">&#39;tenure_years&#39;</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">segments</span><span class="p">),</span> <span class="n">feature_names</span>

<span class="c1"># Create customer data</span>
<span class="n">X_cust</span><span class="p">,</span> <span class="n">y_cust</span><span class="p">,</span> <span class="n">cust_features</span> <span class="o">=</span> <span class="n">create_customer_data</span><span class="p">()</span>
<span class="n">segment_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Basic&#39;</span><span class="p">,</span> <span class="s1">&#39;Standard&#39;</span><span class="p">,</span> <span class="s1">&#39;Premium&#39;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Customer dataset: </span><span class="si">{</span><span class="n">X_cust</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Segment distribution: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">y_cust</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Split data</span>
<span class="n">X_train_cust</span><span class="p">,</span> <span class="n">X_test_cust</span><span class="p">,</span> <span class="n">y_train_cust</span><span class="p">,</span> <span class="n">y_test_cust</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X_cust</span><span class="p">,</span> <span class="n">y_cust</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y_cust</span>
<span class="p">)</span>

<span class="c1"># Create business-relevant fuzzy variables</span>
<span class="n">age_segments</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="p">(</span>
    <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">X_train_cust</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
    <span class="n">terms</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;young&#39;</span><span class="p">,</span> <span class="s1">&#39;adult&#39;</span><span class="p">,</span> <span class="s1">&#39;middle_aged&#39;</span><span class="p">,</span> <span class="s1">&#39;senior&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">income_segments</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="p">(</span>
    <span class="s2">&quot;income&quot;</span><span class="p">,</span> <span class="n">X_train_cust</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="mi">4</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
    <span class="n">terms</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="s1">&#39;medium&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;very_high&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">spending_segments</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="p">(</span>
    <span class="s2">&quot;spending&quot;</span><span class="p">,</span> <span class="n">X_train_cust</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
    <span class="n">terms</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;low_spender&#39;</span><span class="p">,</span> <span class="s1">&#39;moderate_spender&#39;</span><span class="p">,</span> <span class="s1">&#39;high_spender&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">tenure_segments</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="p">(</span>
    <span class="s2">&quot;tenure&quot;</span><span class="p">,</span> <span class="n">X_train_cust</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span>
    <span class="n">terms</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="s1">&#39;established&#39;</span><span class="p">,</span> <span class="s1">&#39;loyal&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">business_variables</span> <span class="o">=</span> <span class="p">[</span><span class="n">age_segments</span><span class="p">,</span> <span class="n">income_segments</span><span class="p">,</span> <span class="n">spending_segments</span><span class="p">,</span> <span class="n">tenure_segments</span><span class="p">]</span>

<span class="c1"># Train business classifier</span>
<span class="n">business_classifier</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">RuleMineClassifier</span><span class="p">(</span>
    <span class="n">nRules</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
    <span class="n">nAnts</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">linguistic_variables</span><span class="o">=</span><span class="n">business_variables</span><span class="p">,</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">business_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_cust</span><span class="p">,</span> <span class="n">y_train_cust</span><span class="p">)</span>

<span class="c1"># Evaluate business classifier</span>
<span class="n">cust_accuracy</span> <span class="o">=</span> <span class="n">business_classifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test_cust</span><span class="p">,</span> <span class="n">y_test_cust</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Customer segmentation accuracy: </span><span class="si">{</span><span class="n">cust_accuracy</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">y_pred_cust</span> <span class="o">=</span> <span class="n">business_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_cust</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">nBusiness Classification Report:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test_cust</span><span class="p">,</span> <span class="n">y_pred_cust</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="n">segment_names</span><span class="p">))</span>

<span class="c1"># Business insights from rules (example interpretations)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">nBusiness Insights from Fuzzy Rules:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- High income + High spending → Premium segment&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Long tenure + Moderate spending → Standard segment&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Young age + Low income → Basic segment&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Senior age + High income → Premium segment&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="model-interpretation-and-analysis">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Model Interpretation and Analysis</a><a class="headerlink" href="#model-interpretation-and-analysis" title="Link to this heading">#</a></h2>
<section id="rule-analysis">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Rule Analysis</a><a class="headerlink" href="#rule-analysis" title="Link to this heading">#</a></h3>
<p>Understanding what the model learned:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Comprehensive model evaluation</span>
<span class="n">comprehensive_report</span> <span class="o">=</span> <span class="n">eval_tools</span><span class="o">.</span><span class="n">eval_fuzzy_model</span><span class="p">(</span>
    <span class="n">fl_classifier</span><span class="o">=</span><span class="n">classifier</span><span class="p">,</span>
    <span class="n">X_train</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span>
    <span class="n">y_train</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span>
    <span class="n">X_test</span><span class="o">=</span><span class="n">X_test</span><span class="p">,</span>
    <span class="n">y_test</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span>
    <span class="n">plot_rules</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">print_rules</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">plot_partitions</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">bootstrap_results_print</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">comprehensive_report</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="feature-importance">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Feature Importance</a><a class="headerlink" href="#feature-importance" title="Link to this heading">#</a></h3>
<p>Analyzing which features are most important:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">analyze_feature_importance</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Analyze feature importance in fuzzy rules.&quot;&quot;&quot;</span>
    <span class="n">rules</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">get_rules</span><span class="p">()</span>
    <span class="n">feature_usage</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">feature_names</span><span class="p">}</span>

    <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">var_idx</span><span class="p">,</span> <span class="n">term_idx</span> <span class="ow">in</span> <span class="n">rule</span><span class="o">.</span><span class="n">antecedents</span><span class="p">:</span>
            <span class="n">feature_usage</span><span class="p">[</span><span class="n">feature_names</span><span class="p">[</span><span class="n">var_idx</span><span class="p">]]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># Normalize by total number of rule conditions</span>
    <span class="n">total_conditions</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">feature_usage</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">importance_scores</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span><span class="p">:</span> <span class="n">count</span> <span class="o">/</span> <span class="n">total_conditions</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">feature_usage</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">importance_scores</span>

<span class="c1"># Analyze feature importance</span>
<span class="n">importance</span> <span class="o">=</span> <span class="n">analyze_feature_importance</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Feature Importance in Fuzzy Rules:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">feature</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">importance</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">feature</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">score</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="prediction-explanation">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">Prediction Explanation</a><a class="headerlink" href="#prediction-explanation" title="Link to this heading">#</a></h3>
<p>Explaining individual predictions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">explain_prediction</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">X_sample</span><span class="p">,</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">class_names</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Explain a single prediction.&quot;&quot;&quot;</span>
    <span class="c1"># Get prediction and probability</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">X_sample</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">probabilities</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">([</span><span class="n">X_sample</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input: </span><span class="si">{</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">feature_names</span><span class="p">,</span><span class="w"> </span><span class="n">X_sample</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predicted class: </span><span class="si">{</span><span class="n">class_names</span><span class="p">[</span><span class="n">prediction</span><span class="p">]</span><span class="si">}</span><span class="s2"> (confidence: </span><span class="si">{</span><span class="n">probabilities</span><span class="p">[</span><span class="n">prediction</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All probabilities: </span><span class="si">{</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">class_names</span><span class="p">,</span><span class="w"> </span><span class="n">probabilities</span><span class="p">))</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Get fired rules (this would require access to the rule firing mechanism)</span>
    <span class="c1"># This is a simplified example - actual implementation would depend on classifier internals</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">nMost relevant rules (conceptual):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;- IF </span><span class="si">{</span><span class="n">feature_names</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2"> is high AND </span><span class="si">{</span><span class="n">feature_names</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="si">}</span><span class="s2"> is wide THEN </span><span class="si">{</span><span class="n">class_names</span><span class="p">[</span><span class="n">prediction</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">prediction</span><span class="p">,</span> <span class="n">probabilities</span>

<span class="c1"># Explain a few test samples</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n--- Sample </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> ---&quot;</span><span class="p">)</span>
    <span class="n">explain_prediction</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">X_test</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">feature_names</span><span class="p">,</span> <span class="n">class_names</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="cross-validation-and-robustness">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Cross-Validation and Robustness</a><a class="headerlink" href="#cross-validation-and-robustness" title="Link to this heading">#</a></h2>
<section id="robust-evaluation">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">Robust Evaluation</a><a class="headerlink" href="#robust-evaluation" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">StratifiedKFold</span><span class="p">,</span> <span class="n">cross_validate</span>

<span class="c1"># Define multiple metrics</span>
<span class="n">scoring</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;f1_macro&#39;</span><span class="p">:</span> <span class="s1">&#39;f1_macro&#39;</span><span class="p">,</span>
    <span class="s1">&#39;f1_weighted&#39;</span><span class="p">:</span> <span class="s1">&#39;f1_weighted&#39;</span><span class="p">,</span>
    <span class="s1">&#39;precision_macro&#39;</span><span class="p">:</span> <span class="s1">&#39;precision_macro&#39;</span><span class="p">,</span>
    <span class="s1">&#39;recall_macro&#39;</span><span class="p">:</span> <span class="s1">&#39;recall_macro&#39;</span>
<span class="p">}</span>

<span class="c1"># Perform comprehensive cross-validation</span>
<span class="n">cv_results</span> <span class="o">=</span> <span class="n">cross_validate</span><span class="p">(</span>
    <span class="n">classifier</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span>
    <span class="n">cv</span><span class="o">=</span><span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
    <span class="n">scoring</span><span class="o">=</span><span class="n">scoring</span><span class="p">,</span>
    <span class="n">return_train_score</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span>

<span class="c1"># Display results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cross-Validation Results:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="n">scoring</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">test_scores</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;test_</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
    <span class="n">train_scores</span> <span class="o">=</span> <span class="n">cv_results</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;train_</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">metric</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Test:  </span><span class="si">{</span><span class="n">test_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (+/- </span><span class="si">{</span><span class="n">test_scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Train: </span><span class="si">{</span><span class="n">train_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (+/- </span><span class="si">{</span><span class="n">train_scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="model-comparison">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Model Comparison</a><a class="headerlink" href="#model-comparison" title="Link to this heading">#</a></h3>
<p>Comparing fuzzy classifier with other methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.ensemble</span><span class="w"> </span><span class="kn">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.svm</span><span class="w"> </span><span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.naive_bayes</span><span class="w"> </span><span class="kn">import</span> <span class="n">GaussianNB</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.linear_model</span><span class="w"> </span><span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="c1"># Define models to compare</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Fuzzy Classifier&#39;</span><span class="p">:</span> <span class="n">clf</span><span class="o">.</span><span class="n">RuleMineClassifier</span><span class="p">(</span><span class="n">nRules</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">nAnts</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="s1">&#39;Random Forest&#39;</span><span class="p">:</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span>
    <span class="s1">&#39;SVM&#39;</span><span class="p">:</span> <span class="n">SVC</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="s1">&#39;Naive Bayes&#39;</span><span class="p">:</span> <span class="n">GaussianNB</span><span class="p">(),</span>
    <span class="s1">&#39;Logistic Regression&#39;</span><span class="p">:</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Compare models</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (+/- </span><span class="si">{</span><span class="n">scores</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

<span class="c1"># Statistical significance testing</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="kn">import</span> <span class="n">stats</span>

<span class="n">fuzzy_scores</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;Fuzzy Classifier&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">scores</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;Fuzzy Classifier&#39;</span><span class="p">:</span>
        <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_rel</span><span class="p">(</span><span class="n">fuzzy_scores</span><span class="p">,</span> <span class="n">scores</span><span class="p">)</span>
        <span class="n">significance</span> <span class="o">=</span> <span class="s2">&quot;***&quot;</span> <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.001</span> <span class="k">else</span> <span class="s2">&quot;**&quot;</span> <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.01</span> <span class="k">else</span> <span class="s2">&quot;*&quot;</span> <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.05</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fuzzy vs </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: p-value = </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">significance</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="performance-optimization">
<h2><a class="toc-backref" href="#id17" role="doc-backlink">Performance Optimization</a><a class="headerlink" href="#performance-optimization" title="Link to this heading">#</a></h2>
<section id="efficient-training">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Efficient Training</a><a class="headerlink" href="#efficient-training" title="Link to this heading">#</a></h3>
<p>Tips for faster training on large datasets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For large datasets, consider these optimizations:</span>

<span class="c1"># 1. Reduce feature dimensionality</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.feature_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">SelectKBest</span><span class="p">,</span> <span class="n">f_classif</span>

<span class="n">selector</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span><span class="o">=</span><span class="n">f_classif</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Select top 10 features</span>
<span class="n">X_selected</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># 2. Use fewer fuzzy partitions</span>
<span class="n">efficient_classifier</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">RuleMineClassifier</span><span class="p">(</span>
    <span class="n">nRules</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>           <span class="c1"># Fewer rules</span>
    <span class="n">nAnts</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>             <span class="c1"># Simpler rules</span>
    <span class="n">fuzzy_partitions</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>  <span class="c1"># Fewer partitions per variable</span>
    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>

<span class="c1"># 3. Sample-based training for very large datasets</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span>
    <span class="n">sample_size</span> <span class="o">=</span> <span class="mi">5000</span>
    <span class="n">sample_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">X_sample</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">sample_indices</span><span class="p">]</span>
    <span class="n">y_sample</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">sample_indices</span><span class="p">]</span>

    <span class="n">efficient_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_sample</span><span class="p">,</span> <span class="n">y_sample</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">efficient_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="memory-efficient-processing">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Memory-Efficient Processing</a><a class="headerlink" href="#memory-efficient-processing" title="Link to this heading">#</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># For memory-constrained environments</span>
<span class="k">def</span><span class="w"> </span><span class="nf">batch_predict</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Predict in batches to save memory.&quot;&quot;&quot;</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">batch_size</span><span class="p">):</span>
        <span class="n">batch</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">batch_size</span><span class="p">]</span>
        <span class="n">batch_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">batch_pred</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>

<span class="c1"># Use batch prediction for large test sets</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5000</span><span class="p">:</span>
    <span class="n">y_pred_batch</span> <span class="o">=</span> <span class="n">batch_predict</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">y_pred_batch</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="best-practices-summary">
<h2><a class="toc-backref" href="#id20" role="doc-backlink">Best Practices Summary</a><a class="headerlink" href="#best-practices-summary" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Data Preparation</strong>
- Normalize features if they have different scales
- Handle missing values appropriately
- Consider feature selection for high-dimensional data</p></li>
<li><p><strong>Model Configuration</strong>
- Start with 3-5 fuzzy partitions per variable
- Use 10-30 rules depending on problem complexity
- Limit rule antecedents to 2-4 for interpretability</p></li>
<li><p><strong>Evaluation</strong>
- Always use cross-validation for robust estimates
- Consider multiple metrics (accuracy, F1, precision, recall)
- Use stratified splits for imbalanced data</p></li>
<li><p><strong>Interpretability</strong>
- Design meaningful linguistic variable names
- Analyze rule importance and coverage
- Visualize fuzzy partitions and rules</p></li>
<li><p><strong>Performance</strong>
- Use hyperparameter tuning for optimal results
- Consider ensemble methods for complex problems
- Monitor training time vs. accuracy trade-offs</p></li>
</ol>
</section>
<section id="next-steps">
<h2><a class="toc-backref" href="#id21" role="doc-backlink">Next Steps</a><a class="headerlink" href="#next-steps" title="Link to this heading">#</a></h2>
<p>After mastering basic classification:</p>
<ol class="arabic simple">
<li><p><strong>Advanced Techniques</strong>: Explore Type-2 and General Type-2 fuzzy sets</p></li>
<li><p><strong>Ensemble Methods</strong>: Combine multiple fuzzy classifiers</p></li>
<li><p><strong>Online Learning</strong>: Adapt classifiers to streaming data</p></li>
<li><p><strong>Domain Applications</strong>: Apply to specific domains (medical, financial, etc.)</p></li>
</ol>
<p>Related Examples:</p>
<ul class="simple">
<li><p><span class="xref std std-doc">regression</span> - Fuzzy regression techniques</p></li>
<li><p><span class="xref std std-doc">time-series</span> - Temporal fuzzy classification</p></li>
<li><p><span class="xref std std-doc">clustering</span> - Fuzzy clustering methods</p></li>
<li><p><span class="xref std std-doc">optimization</span> - Advanced optimization techniques</p></li>
</ul>
</section>
</section>


                </article>
              
              
              
              
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-classification">Basic Classification</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#iris-classification">Iris Classification</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alternative-classifiers">Alternative Classifiers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-class-classification">Multi-Class Classification</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example-output">Example Output</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#working-with-different-fuzzy-set-types">Working with Different Fuzzy Set Types</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#direct-use-of-basefuzzyrulesclassifier">Direct Use of BaseFuzzyRulesClassifier</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#available-evaluation-tools">Available Evaluation Tools</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#customer-segmentation">Customer Segmentation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-interpretation-and-analysis">Model Interpretation and Analysis</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rule-analysis">Rule Analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#feature-importance">Feature Importance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediction-explanation">Prediction Explanation</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cross-validation-and-robustness">Cross-Validation and Robustness</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#robust-evaluation">Robust Evaluation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-comparison">Model Comparison</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-optimization">Performance Optimization</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#efficient-training">Efficient Training</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#memory-efficient-processing">Memory-Efficient Processing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#best-practices-summary">Best Practices Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#next-steps">Next Steps</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/examples/classification.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023-2025, Javier Fumanal Idocin.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>