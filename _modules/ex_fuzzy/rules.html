
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ex_fuzzy.rules &#8212; Ex-Fuzzy 1.0.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=edfbbfd1" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=30646c52"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/ex_fuzzy/rules';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.0.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs..."
         aria-label="Search the docs..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo-light.png" class="logo__image only-light" alt=""/>
    <img src="../../_static/logo-dark.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">Ex-Fuzzy</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API Reference
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../api/fuzzy_sets.html">
    Fuzzy Sets
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../api/classifiers.html">
    Classifiers Module
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../api/evolutionary_fit.html">
    Evolutionary Fit Module
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../api/eval_tools.html">
    Evaluation Tools Module
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../contributing.html">
    Contributing
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../changelog.html">
    Changelog
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../roadmap.html">
    Roadmap
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../usage.html">
    Getting Started
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../step1.html">
    Creating fuzzy sets and fuzzy variables
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../step2.html">
    Using Fuzzy Rules
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../step3.html">
    Optimizing a Fuzzy rule base for a classification problem
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../step4.html">
    Visualize rules and results
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../precom.html">
    Computing fuzzy partitions
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../optimize.html">
    Genetic algorithm details
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../gt2.html">
    General Type 2
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../tmpfs.html">
    Temporal Fuzzy Sets
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../extending.html">
    Extending Ex-Fuzzy
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../persistence.html">
    Persistence
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../classifiers.html">
    Advanced classifiers
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../pattern_stats.html">
    Bootstrapping and rule robustness
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/fuminides/ex-fuzzy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/ex-fuzzy/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/fuzzy_sets.html">
    Fuzzy Sets
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/classifiers.html">
    Classifiers Module
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/evolutionary_fit.html">
    Evolutionary Fit Module
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/eval_tools.html">
    Evaluation Tools Module
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../changelog.html">
    Changelog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../roadmap.html">
    Roadmap
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../usage.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../step1.html">
    Creating fuzzy sets and fuzzy variables
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../step2.html">
    Using Fuzzy Rules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../step3.html">
    Optimizing a Fuzzy rule base for a classification problem
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../step4.html">
    Visualize rules and results
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../precom.html">
    Computing fuzzy partitions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../optimize.html">
    Genetic algorithm details
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../gt2.html">
    General Type 2
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tmpfs.html">
    Temporal Fuzzy Sets
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../extending.html">
    Extending Ex-Fuzzy
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../persistence.html">
    Persistence
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../classifiers.html">
    Advanced classifiers
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../pattern_stats.html">
    Bootstrapping and rule robustness
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/fuminides/ex-fuzzy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/ex-fuzzy/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Module code</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">ex_fuzzy.rules</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>Source code for ex_fuzzy.rules</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Fuzzy Rules and Inference Engine for Ex-Fuzzy Library</span>

<span class="sd">This module contains the core classes and functions for fuzzy rule definition, management,</span>
<span class="sd">and inference. It implements a complete fuzzy inference system supporting Type-1, Type-2,</span>
<span class="sd">and General Type-2 fuzzy sets with various t-norm operations and defuzzification methods.</span>

<span class="sd">Main Components:</span>
<span class="sd">    - Rule classes: RuleSimple for individual rule representation  </span>
<span class="sd">    - RuleBase classes: RuleBaseT1, RuleBaseT2, RuleBaseGT2 for rule collections</span>
<span class="sd">    - MasterRuleBase: Container for multiple rule bases (multi-class problems)</span>
<span class="sd">    - Inference engines: Support for Mamdani and Takagi-Sugeno inference</span>
<span class="sd">    - Defuzzification: Centroid, height, and other defuzzification methods</span>
<span class="sd">    - T-norm operations: Product, minimum, and other aggregation functions</span>

<span class="sd">The module supports complex fuzzy reasoning workflows including rule firing strength</span>
<span class="sd">computation, aggregation across multiple rules, and final defuzzification to crisp outputs.</span>
<span class="sd">It also includes support for rule modifiers (e.g., &quot;very&quot;, &quot;somewhat&quot;) and dominance scores</span>
<span class="sd">for rule quality assessment.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">abc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numbers</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">fuzzy_sets</span> <span class="k">as</span> <span class="n">fs</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">centroid</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">fuzzy_sets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fs</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">centroid</span>

<span class="n">modifiers_names</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.5</span><span class="p">:</span> <span class="s1">&#39;Somewhat&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">:</span> <span class="s1">&#39;A little&#39;</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">:</span> <span class="s1">&#39;Slightly&#39;</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">:</span> <span class="s1">&#39;Very&#39;</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">:</span> <span class="s1">&#39;Extremely&#39;</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">:</span> <span class="s1">&#39;Very very&#39;</span><span class="p">}</span>

<div class="viewcode-block" id="compute_antecedents_memberships">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.compute_antecedents_memberships">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">compute_antecedents_memberships</span><span class="p">(</span><span class="n">antecedents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="p">],</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute membership degrees for input values across all fuzzy variables.</span>
<span class="sd">    </span>
<span class="sd">    This function calculates the membership degrees of input values for each linguistic</span>
<span class="sd">    variable in the antecedents. It returns a structured representation that can be</span>
<span class="sd">    used for efficient rule evaluation and inference.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        antecedents (list[fs.fuzzyVariable]): List of fuzzy variables representing</span>
<span class="sd">            the antecedents (input variables) of the fuzzy system</span>
<span class="sd">        x (np.array): Input vector with values for each antecedent variable.</span>
<span class="sd">            Shape should be (n_samples, n_variables) or (n_variables,) for single sample</span>
<span class="sd">            </span>
<span class="sd">    Returns:</span>
<span class="sd">        list[dict]: List containing membership dictionaries for each antecedent variable.</span>
<span class="sd">            Each dictionary maps linguistic term indices to their membership degrees.</span>
<span class="sd">            </span>
<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # For 2 variables with 3 linguistic terms each</span>
<span class="sd">        &gt;&gt;&gt; antecedents = [temp_var, pressure_var]  </span>
<span class="sd">        &gt;&gt;&gt; x = np.array([25.0, 101.3])  # temperature=25°C, pressure=101.3kPa</span>
<span class="sd">        &gt;&gt;&gt; memberships = compute_antecedents_memberships(antecedents, x)</span>
<span class="sd">        &gt;&gt;&gt; # memberships[0] contains temperature memberships: {0: 0.2, 1: 0.8, 2: 0.0}</span>
<span class="sd">        &gt;&gt;&gt; # memberships[1] contains pressure memberships: {0: 0.0, 1: 0.6, 2: 0.4}</span>
<span class="sd">        </span>
<span class="sd">    Note:</span>
<span class="sd">        This function is typically used internally during rule evaluation but can be</span>
<span class="sd">        useful for debugging membership degree calculations or analyzing input fuzzification.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">cache_antecedent_memberships</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">antecedent</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">antecedents</span><span class="p">):</span>
        <span class="n">cache_antecedent_memberships</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="n">antecedent</span><span class="o">.</span><span class="n">compute_memberships</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">ix</span><span class="p">]))</span>

    <span class="k">return</span> <span class="n">cache_antecedent_memberships</span></div>


        
            
<div class="viewcode-block" id="RuleError">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleError">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">RuleError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exception raised when a fuzzy rule is incorrectly defined or invalid.</span>
<span class="sd">    </span>
<span class="sd">    This exception is used throughout the rules module to indicate various</span>
<span class="sd">    rule-related errors such as invalid antecedent specifications, inconsistent</span>
<span class="sd">    membership functions, or malformed rule structures.</span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        message (str): Human-readable description of the error</span>
<span class="sd">        </span>
<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; try:</span>
<span class="sd">        ...     rule = RuleSimple([-1, -1, -1], 0)  # Invalid: all don&#39;t-care antecedents</span>
<span class="sd">        ... except RuleError as e:</span>
<span class="sd">        ...     print(f&quot;Rule error: {e}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="RuleError.__init__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleError.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize the RuleError exception.</span>

<span class="sd">        Args:</span>
<span class="sd">            message (str): Descriptive error message explaining what went wrong</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">message</span><span class="p">)</span></div>
</div>




<span class="k">def</span><span class="w"> </span><span class="nf">_myprod</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Proxy function to change the product operation interface</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span>


<div class="viewcode-block" id="Rule">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.Rule">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Rule</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class of Rule designed to work with one single rule. It contains the whole inference functionally in itself.</span>
<span class="sd">    &#39;&#39;&#39;</span>

<div class="viewcode-block" id="Rule.__init__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.Rule.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">antecedents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">fs</span><span class="o">.</span><span class="n">FS</span><span class="p">],</span> <span class="n">consequent</span><span class="p">:</span> <span class="n">fs</span><span class="o">.</span><span class="n">FS</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creates a rule with the given antecedents and consequent.</span>

<span class="sd">        :param antecedents: list of fuzzy sets.</span>
<span class="sd">        :param consequent: fuzzy set.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">=</span> <span class="n">antecedents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="o">=</span> <span class="n">consequent</span></div>



<div class="viewcode-block" id="Rule.membership">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.Rule.membership">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">membership</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">tnorm</span><span class="o">=</span><span class="n">_myprod</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the membership of one input to the antecedents of the rule.</span>

<span class="sd">        :param x: input to compute the membership.</span>
<span class="sd">        :param tnorm: t-norm to use in the inference process.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">antecedent</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">antecedent</span><span class="o">.</span><span class="n">membership</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="n">ix</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">tnorm</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">antecedent</span><span class="o">.</span><span class="n">membership</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span><span class="n">ix</span><span class="p">]))</span>

        <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="Rule.consequent_centroid">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.Rule.consequent_centroid">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">consequent_centroid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the centroid of the consequent using a Karnik and Mendel algorithm.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">centroid_consequent</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">consequent_domain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">domain</span>
            <span class="n">domain_linspace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                <span class="n">consequent_domain</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">consequent_domain</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.05</span><span class="p">)</span>
            <span class="n">consequent_memberships</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="o">.</span><span class="n">membership</span><span class="p">(</span>
                <span class="n">domain_linspace</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">centroid_consequent</span> <span class="o">=</span> <span class="n">centroid</span><span class="o">.</span><span class="n">compute_centroid_fs</span><span class="p">(</span>
                <span class="n">domain_linspace</span><span class="p">,</span> <span class="n">consequent_memberships</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">centroid_consequent</span></div>
</div>




<div class="viewcode-block" id="RuleSimple">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleSimple">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">RuleSimple</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simplified Rule Representation for Optimized Computation.</span>
<span class="sd">    </span>
<span class="sd">    This class represents fuzzy rules in a simplified format optimized for</span>
<span class="sd">    computational efficiency in rule base operations. It uses integer encoding</span>
<span class="sd">    for antecedents and consequents to minimize memory usage and speed up</span>
<span class="sd">    rule evaluation processes.</span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        antecedents (list[int]): Integer-encoded antecedents where:</span>
<span class="sd">            - -1: Variable not used in the rule</span>
<span class="sd">            - 0-N: Index of the linguistic variable used for the ith input</span>
<span class="sd">        consequent (int): Integer index of the consequent linguistic variable</span>
<span class="sd">        modifiers (np.array): Optional modifiers for rule adaptation</span>
<span class="sd">        </span>
<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # Rule: IF x1 is Low AND x2 is High THEN y is Medium</span>
<span class="sd">        &gt;&gt;&gt; # Assuming Low=0, High=1, Medium=1</span>
<span class="sd">        &gt;&gt;&gt; rule = RuleSimple([0, 1], consequent=1)</span>
<span class="sd">        &gt;&gt;&gt; print(rule.antecedents)  # [0, 1]</span>
<span class="sd">        &gt;&gt;&gt; print(rule.consequent)  # 1</span>
<span class="sd">        </span>
<span class="sd">    Note:</span>
<span class="sd">        This simplified representation is designed for high-performance</span>
<span class="sd">        rule evaluation in large rule bases where memory and speed are critical.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="RuleSimple.__init__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleSimple.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">antecedents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">consequent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">modifiers</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a rule with the given antecedents and consequent.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            antecedents (list[int]): List of integers indicating the linguistic </span>
<span class="sd">                variable used for each input (-1 for unused variables)</span>
<span class="sd">            consequent (int, optional): Integer indicating the linguistic variable </span>
<span class="sd">                used for the consequent. Defaults to 0.</span>
<span class="sd">            modifiers (np.array, optional): Array of modifier values for rule adaptation.</span>
<span class="sd">                Defaults to None.</span>
<span class="sd">                </span>
<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; # Create a rule with two antecedents and one consequent</span>
<span class="sd">            &gt;&gt;&gt; rule = RuleSimple([0, 2, -1], consequent=1)  # x1=0, x2=2, x3=unused, y=1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">antecedents</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">consequent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modifiers</span> <span class="o">=</span> <span class="n">modifiers</span></div>


<div class="viewcode-block" id="RuleSimple.__getitem__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleSimple.__getitem__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ix</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the antecedent value for the given index.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            ix (int): Index of the antecedent to return</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            int: The antecedent value at the specified index</span>
<span class="sd">            </span>
<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; rule = RuleSimple([0, 1, 2])</span>
<span class="sd">            &gt;&gt;&gt; print(rule[1])  # 1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span></div>


<div class="viewcode-block" id="RuleSimple.__setitem__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleSimple.__setitem__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ix</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the antecedent value for the given index.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            ix (int): Index of the antecedent to set</span>
<span class="sd">            value (int): Value to set at the specified index</span>
<span class="sd">            </span>
<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; rule = RuleSimple([0, 1, 2])</span>
<span class="sd">            &gt;&gt;&gt; rule[1] = 3  # Change second antecedent to 3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>


<div class="viewcode-block" id="RuleSimple.__str__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleSimple.__str__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a string representation of the rule.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: Human-readable string representation of the rule</span>
<span class="sd">            </span>
<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; rule = RuleSimple([0, 1], consequent=2)</span>
<span class="sd">            &gt;&gt;&gt; print(rule)  # Rule: antecedents: [0, 1] consequent: 2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="s1">&#39;Rule: antecedents: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; consequent: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modifiers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">aux</span> <span class="o">+=</span> <span class="s1">&#39; modifiers: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modifiers</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="n">aux</span> <span class="o">+=</span> <span class="s1">&#39; score: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">aux</span> <span class="o">+=</span> <span class="s1">&#39; weight: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
    
        <span class="k">try</span><span class="p">:</span>
            <span class="n">aux</span> <span class="o">+=</span> <span class="s1">&#39; accuracy: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">accuracy</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">aux</span> <span class="o">+=</span> <span class="s1">&#39; p-value class structure: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_value_class_structure</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">aux</span> <span class="o">+=</span> <span class="s1">&#39; p-value feature coalitions: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_value_feature_coalitions</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">aux</span> <span class="o">+=</span> <span class="s1">&#39; p-value bootstrapping membership validation: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_p_value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">aux</span> <span class="o">+=</span> <span class="s1">&#39; bootstrapping confidence conf. interval: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_confidence_interval</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">aux</span> <span class="o">+=</span> <span class="s1">&#39; bootstrapping support conf. interval: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">boot_support_interval</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
            

        <span class="k">return</span> <span class="n">aux</span></div>


<div class="viewcode-block" id="RuleSimple.__len__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleSimple.__len__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the number of antecedents in the rule.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            int: Number of antecedents in the rule</span>
<span class="sd">            </span>
<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; rule = RuleSimple([0, 1, 2])</span>
<span class="sd">            &gt;&gt;&gt; print(len(rule))  # 3</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span><span class="p">)</span></div>


<div class="viewcode-block" id="RuleSimple.__eq__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleSimple.__eq__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns True if the two rules are equal.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            other (RuleSimple): Another rule to compare with</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            bool: True if rules have identical antecedents and consequent</span>
<span class="sd">            </span>
<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; rule1 = RuleSimple([0, 1], consequent=2)</span>
<span class="sd">            &gt;&gt;&gt; rule2 = RuleSimple([0, 1], consequent=2)</span>
<span class="sd">            &gt;&gt;&gt; print(rule1 == rule2)  # True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">antecedents</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">consequent</span></div>


<div class="viewcode-block" id="RuleSimple.__hash__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleSimple.__hash__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the hash of the rule.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>
</div>




<div class="viewcode-block" id="RuleBase">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">RuleBase</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class optimized to work with multiple rules at the same time. Right now supports only one consequent. (Solution: use one rulebase per consequent to study)</span>
<span class="sd">    &#39;&#39;&#39;</span>

<div class="viewcode-block" id="RuleBase.__init__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">antecedents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="p">],</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">RuleSimple</span><span class="p">],</span> <span class="n">consequent</span><span class="p">:</span> <span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tnorm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creates a rulebase with the given antecedents, rules and consequent.</span>

<span class="sd">        :param antecedents: list of fuzzy sets.</span>
<span class="sd">        :param rules: list of rules.</span>
<span class="sd">        :param consequent: fuzzy set.</span>
<span class="sd">        :param tnorm: t-norm to use in the inference process.</span>
<span class="sd">        :param fuzzy_modifiers: array with the fuzzy modifiers for each rule. If None, no modifiers are used. (Fuzzy modifiers are modifiers to the antecedent memberships, also known as linguistic hedges). Only exponentiation is supported. (x**a, being a the modifier in the matrix). Defaults to None. They can also be specified in the RuleSimple list of rules.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">rules</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_rule_duplicates</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules</span> <span class="o">=</span> <span class="n">rules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">=</span> <span class="n">antecedents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="o">=</span> <span class="n">consequent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tnorm</span> <span class="o">=</span> <span class="n">tnorm</span>

        <span class="k">if</span> <span class="n">consequent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">consequent</span><span class="o">.</span><span class="n">linguistic_variable_names</span><span class="p">()),</span> <span class="mi">2</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">vl_consequent</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">consequent</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">):</span>
                <span class="n">consequent_domain</span> <span class="o">=</span> <span class="n">vl_consequent</span><span class="o">.</span><span class="n">domain</span>
                <span class="n">domain_linspace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                    <span class="n">consequent_domain</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">consequent_domain</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.05</span><span class="p">)</span>
                <span class="n">consequent_memberships</span> <span class="o">=</span> <span class="n">vl_consequent</span><span class="o">.</span><span class="n">membership</span><span class="p">(</span><span class="n">domain_linspace</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids</span><span class="p">[</span><span class="n">ix</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">centroid</span><span class="o">.</span><span class="n">compute_centroid_iv</span><span class="p">(</span>
                    <span class="n">domain_linspace</span><span class="p">,</span> <span class="n">consequent_memberships</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids_rules</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">):</span>
                <span class="n">consequent_ix</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">consequent</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids_rules</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids</span><span class="p">[</span><span class="n">consequent_ix</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">delete_duplicates</span><span class="p">()</span></div>



<div class="viewcode-block" id="RuleBase.get_rules">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.get_rules">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">RuleSimple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the list of rules in the rulebase.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span></div>



<div class="viewcode-block" id="RuleBase.add_rule">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.add_rule">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_rule</span><span class="p">:</span> <span class="n">RuleSimple</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Adds a new rule to the rulebase.</span>
<span class="sd">        :param new_rule: rule to add.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_rule</span><span class="p">)</span></div>



<div class="viewcode-block" id="RuleBase.add_rules">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.add_rules">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">RuleSimple</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Adds a list of new rules to the rulebase.</span>

<span class="sd">        :param new_rules: list of rules to add.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules</span> <span class="o">+=</span> <span class="n">new_rules</span></div>



<div class="viewcode-block" id="RuleBase.remove_rule">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.remove_rule">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ix</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Removes the rule in the given index.</span>
<span class="sd">        :param ix: index of the rule to remove.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span></div>



<div class="viewcode-block" id="RuleBase.remove_rules">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.remove_rules">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delete_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Removes the rules in the given list of indexes.</span>

<span class="sd">        :param delete_list: list of indexes of the rules to remove.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules</span> <span class="o">=</span> <span class="p">[</span><span class="n">rule</span> <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span> <span class="k">if</span> <span class="n">ix</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">delete_list</span><span class="p">]</span></div>



<div class="viewcode-block" id="RuleBase.get_rulebase_matrix">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.get_rulebase_matrix">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_rulebase_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a matrix with the antecedents values for each rule.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span><span class="p">)))</span>

        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">rule</span>

        <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="RuleBase.get_scores">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.get_scores">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns an array with the dominance score for each rule.</span>
<span class="sd">        (Must been already computed by an evalRule object)</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">,</span> <span class="p">)))</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">score</span>

        <span class="k">return</span> <span class="n">res</span></div>

    

<div class="viewcode-block" id="RuleBase.get_weights">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.get_weights">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns an array with the weights for each rule.</span>
<span class="sd">        (Different from dominance scores: must been already computed by an optimization algorithm)</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">,</span> <span class="p">)))</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">weight</span>

        <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="RuleBase.delete_rule_duplicates">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.delete_rule_duplicates">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">delete_rule_duplicates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_rules</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">RuleSimple</span><span class="p">]):</span>
        <span class="c1"># Delete the rules that are duplicated in the rule list</span>
        <span class="n">unique</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">list_rules</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">unique</span><span class="p">[</span><span class="n">rule</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">unique</span><span class="p">[</span><span class="n">rule</span><span class="p">]</span> <span class="o">=</span> <span class="n">ix</span>

        <span class="n">new_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">list_rules</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">unique</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
        
        <span class="k">return</span> <span class="n">new_list</span></div>

        

<div class="viewcode-block" id="RuleBase.compute_antecedents_memberships">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.compute_antecedents_memberships">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_antecedents_memberships</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a list of of dictionaries that contains the memberships for each x value to the ith antecedents, nth linguistic variable.</span>
<span class="sd">        x must be a vector (only one sample)</span>

<span class="sd">        :param x: vector with the values of the inputs.</span>
<span class="sd">        :return: a list with the antecedent truth values for each one. Each list is comprised of a list with n elements, where n is the number of linguistic variables in each variable.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cache_antecedent_memberships</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">antecedent</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span><span class="p">):</span>
                <span class="c1"># Check if x is pandas </span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;values&#39;</span><span class="p">):</span>
                    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">values</span>

                <span class="n">cache_antecedent_memberships</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">antecedent</span><span class="o">.</span><span class="n">compute_memberships</span><span class="p">(</span><span class="n">x</span><span class="p">[:,</span> <span class="n">ix</span><span class="p">]))</span>

            <span class="k">return</span> <span class="n">cache_antecedent_memberships</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))]</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">gt2</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span><span class="p">),</span> <span class="mi">2</span><span class="p">))]</span></div>



<div class="viewcode-block" id="RuleBase.compute_rule_antecedent_memberships">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.compute_rule_antecedent_memberships">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_rule_antecedent_memberships</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">antecedents_memberships</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the antecedent truth value of an input array.</span>

<span class="sd">        Return an array in shape samples x rules (x 2) (last is iv dimension)</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :param scaled: if True, the memberships are scaled according to their sums for each sample.</span>
<span class="sd">        :return: array with the memberships of the antecedents for each rule.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">),</span> <span class="p">))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">gt2</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">antecedents_memberships</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">antecedents_memberships</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_antecedents_memberships</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">jx</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">):</span>
            <span class="n">rule_antecedents</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">antecedents</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">fuzzy_modifier</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">modifiers</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">fuzzy_modifier</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">:</span>
                <span class="n">membership</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">rule_antecedents</span><span class="p">)))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span><span class="p">:</span>
                <span class="n">membership</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">rule_antecedents</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">gt2</span><span class="p">:</span>
                <span class="n">membership</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">rule_antecedents</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>

            <span class="n">n_nonvl</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">vl</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rule_antecedents</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">vl</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">membership_antecedent</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">antecedents_memberships</span><span class="p">[</span><span class="n">ix</span><span class="p">])[</span><span class="n">vl</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">fuzzy_modifier</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">fuzzy_modifier</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">membership</span><span class="p">[:,</span> <span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">membership_antecedent</span><span class="o">**</span><span class="n">fuzzy_modifier</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">membership</span><span class="p">[:,</span> <span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">membership_antecedent</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">membership</span><span class="p">[:,</span> <span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">membership_antecedent</span>

                    <span class="n">n_nonvl</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">membership</span><span class="p">[:,</span> <span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

            <span class="k">if</span> <span class="n">n_nonvl</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">membership</span><span class="p">[:,</span> <span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

            <span class="n">membership</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tnorm</span><span class="p">(</span><span class="n">membership</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">res</span><span class="p">[:,</span> <span class="n">jx</span><span class="p">]</span> <span class="o">=</span> <span class="n">membership</span>
            <span class="k">except</span> <span class="ne">UnboundLocalError</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># All the antecedents are dont care.</span>

        <span class="k">if</span> <span class="n">scaled</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">:</span>
                <span class="n">non_zero_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
                <span class="n">res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">]</span> <span class="o">/</span> \
                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span><span class="p">:</span>
                <span class="n">non_zero_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">res</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
                <span class="n">res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> \
                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">non_zero_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">res</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
                <span class="n">res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> \
                    <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">gt2</span><span class="p">:</span>

                <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span><span class="p">):</span>
                    <span class="n">relevant_res</span> <span class="o">=</span> <span class="n">res</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ix</span><span class="p">,</span> <span class="p">:]</span>

                    <span class="n">non_zero_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">relevant_res</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
                    <span class="n">relevant_res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">relevant_res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> \
                        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">relevant_res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">non_zero_rows</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">relevant_res</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
                    <span class="n">relevant_res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">relevant_res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> \
                        <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">relevant_res</span><span class="p">[</span><span class="n">non_zero_rows</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                    <span class="n">res</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">ix</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">relevant_res</span>
                    
        <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="RuleBase.print_rules">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.print_rules">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_rules</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bootstrap_results</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Print the rules from the rule base.</span>

<span class="sd">        :param return_rules: if True, the rules are returned as a string.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">all_rules</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">):</span>
            <span class="n">str_rule</span> <span class="o">=</span> <span class="n">generate_rule_string</span><span class="p">(</span><span class="n">rule</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span><span class="p">,</span> <span class="n">bootstrap_results</span><span class="p">)</span>
            
            <span class="n">all_rules</span> <span class="o">+=</span> <span class="n">str_rule</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">return_rules</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">all_rules</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">all_rules</span></div>


    


<div class="viewcode-block" id="RuleBase.inference">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.inference">[docs]</a>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">inference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the fuzzy output of the fl inference system.</span>

<span class="sd">        Return an array in shape samples x 2 (last is iv dimension)</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :return: array with the memberships of the consequents for each rule.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>



<div class="viewcode-block" id="RuleBase.forward">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.forward">[docs]</a>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the deffuzified output of the fl inference system.</span>

<span class="sd">        Return a vector of size (samples, )</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :return: array with the deffuzified output.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>



<div class="viewcode-block" id="RuleBase.fuzzy_type">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.fuzzy_type">[docs]</a>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fuzzy_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the corresponding type of the RuleBase using the enum type in the fuzzy_sets module.</span>

<span class="sd">        :return: the type of fuzzy set used in the RuleBase.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>



<div class="viewcode-block" id="RuleBase.__len__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.__len__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the number of rules in the rule base.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span></div>



<div class="viewcode-block" id="RuleBase.prune_bad_rules">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.prune_bad_rules">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">prune_bad_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Delete the rules from the rule base that do not have a dominance score superior to the threshold or have 0 accuracy in the training set.</span>

<span class="sd">        :param tolerance: threshold for the dominance score.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">delete_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">):</span>
                <span class="n">score</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">score</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">gt2</span><span class="p">):</span>
                    <span class="n">score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">score</span> <span class="o">&lt;</span> <span class="n">tolerance</span> <span class="ow">or</span> <span class="n">rule</span><span class="o">.</span><span class="n">accuracy</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">delete_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">score</span> <span class="o">&lt;</span> <span class="n">tolerance</span><span class="p">:</span>
                        <span class="n">delete_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span>
                        
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;Dominance scores not computed for this rulebase&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">remove_rules</span><span class="p">(</span><span class="n">delete_list</span><span class="p">)</span></div>



<div class="viewcode-block" id="RuleBase.scores">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.scores">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">scores</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the dominance score for each rule.</span>

<span class="sd">        :return: array with the dominance score for each rule.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">:</span>
            <span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span></div>



<div class="viewcode-block" id="RuleBase.__getitem__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.__getitem__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RuleSimple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the corresponding rulebase.</span>

<span class="sd">        :param item: index of the rule.</span>
<span class="sd">        :return: the corresponding rule.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">[</span><span class="n">item</span><span class="p">]</span></div>



<div class="viewcode-block" id="RuleBase.__setitem__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.__setitem__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">RuleSimple</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set the corresponding rule.</span>

<span class="sd">        :param key: index of the rule.</span>
<span class="sd">        :param value: new rule.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>

    

<div class="viewcode-block" id="RuleBase.__iter__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.__iter__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns an iterator for the rule base.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span></div>



<div class="viewcode-block" id="RuleBase.__str__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.__str__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a string with the rules in the rule base.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">str_res</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">:</span>
            <span class="n">str_res</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">return</span> <span class="n">str_res</span></div>

    

<div class="viewcode-block" id="RuleBase.__eq__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.__eq__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns True if the two rule bases are equal.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">rules</span></div>

    

<div class="viewcode-block" id="RuleBase.__hash__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.__hash__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the hash of the rule base.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

    

<div class="viewcode-block" id="RuleBase.__add__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.__add__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Adds two rule bases.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">RuleBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rules</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">rules</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tnorm</span><span class="p">)</span></div>

    

<div class="viewcode-block" id="RuleBase.n_linguistic_variables">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.n_linguistic_variables">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">n_linguistic_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the number of linguistic variables in the rule base.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span> <span class="k">for</span> <span class="n">amt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span><span class="p">]</span></div>



<div class="viewcode-block" id="RuleBase.print_rule_bootstrap_results">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.print_rule_bootstrap_results">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_rule_bootstrap_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Prints the bootstrap results for each rule.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rule &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - Confidence: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">boot_confidence_interval</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; - Support: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">boot_support_interval</span><span class="p">))</span></div>



<div class="viewcode-block" id="RuleBase.copy">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBase.copy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creates a copy of the RuleBase.</span>
<span class="sd">        </span>
<span class="sd">        :param deep: if True, creates a deep copy. If False, creates a shallow copy.</span>
<span class="sd">        :return: a copy of the RuleBase.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Deep copy all components</span>
        <span class="n">copied_rules</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span>
        <span class="n">copied_antecedents</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span><span class="p">)</span>
        <span class="n">copied_consequent</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
        
        <span class="c1"># Create new instance based on the type</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">RuleBaseT1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">RuleBaseT1</span><span class="p">(</span><span class="n">copied_antecedents</span><span class="p">,</span> <span class="n">copied_rules</span><span class="p">,</span> <span class="n">copied_consequent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tnorm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">RuleBaseT2</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">RuleBaseT2</span><span class="p">(</span><span class="n">copied_antecedents</span><span class="p">,</span> <span class="n">copied_rules</span><span class="p">,</span> <span class="n">copied_consequent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tnorm</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">RuleBaseGT2</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">RuleBaseGT2</span><span class="p">(</span><span class="n">copied_antecedents</span><span class="p">,</span> <span class="n">copied_rules</span><span class="p">,</span> <span class="n">copied_consequent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tnorm</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Base RuleBase class</span>
            <span class="n">new_rb</span> <span class="o">=</span> <span class="n">RuleBase</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">RuleBase</span><span class="p">)</span>
            <span class="n">new_rb</span><span class="o">.</span><span class="n">rules</span> <span class="o">=</span> <span class="n">copied_rules</span>
            <span class="n">new_rb</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">=</span> <span class="n">copied_antecedents</span>
            <span class="n">new_rb</span><span class="o">.</span><span class="n">consequent</span> <span class="o">=</span> <span class="n">copied_consequent</span>
            <span class="n">new_rb</span><span class="o">.</span><span class="n">tnorm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tnorm</span>
            <span class="k">return</span> <span class="n">new_rb</span></div>
</div>

   

<div class="viewcode-block" id="RuleBaseT2">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseT2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">RuleBaseT2</span><span class="p">(</span><span class="n">RuleBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class optimized to work with multiple rules at the same time. Supports only one consequent. </span>
<span class="sd">    (Use one rulebase per consequent to study classification problems. Check MasterRuleBase class for more documentation)</span>

<span class="sd">    This class supports iv approximation for t2 fs.</span>
<span class="sd">    &#39;&#39;&#39;</span>

<div class="viewcode-block" id="RuleBaseT2.__init__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseT2.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">antecedents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="p">],</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">RuleSimple</span><span class="p">],</span> <span class="n">consequent</span><span class="p">:</span> <span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tnorm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Constructor of the RuleBaseT2 class.</span>

<span class="sd">        :param antecedents: list of fuzzy variables that are the antecedents of the rules.</span>
<span class="sd">        :param rules: list of rules.</span>
<span class="sd">        :param consequent: fuzzy variable that is the consequent of the rules.</span>
<span class="sd">        :param tnorm: t-norm used to compute the fuzzy output.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">rules</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_rule_duplicates</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules</span> <span class="o">=</span> <span class="n">rules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">=</span> <span class="n">antecedents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="o">=</span> <span class="n">consequent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tnorm</span> <span class="o">=</span> <span class="n">tnorm</span>

        <span class="k">if</span> <span class="n">consequent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">consequent</span><span class="o">.</span><span class="n">linguistic_variable_names</span><span class="p">()),</span> <span class="mi">2</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">vl_consequent</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">consequent</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">):</span>
                <span class="n">consequent_domain</span> <span class="o">=</span> <span class="n">vl_consequent</span><span class="o">.</span><span class="n">domain</span>
                <span class="n">domain_linspace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                    <span class="n">consequent_domain</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">consequent_domain</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.05</span><span class="p">)</span>
                <span class="n">consequent_memberships</span> <span class="o">=</span> <span class="n">vl_consequent</span><span class="o">.</span><span class="n">membership</span><span class="p">(</span>
                    <span class="n">domain_linspace</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids</span><span class="p">[</span><span class="n">ix</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">centroid</span><span class="o">.</span><span class="n">compute_centroid_iv</span><span class="p">(</span>
                    <span class="n">domain_linspace</span><span class="p">,</span> <span class="n">consequent_memberships</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids_rules</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
            <span class="c1"># If 0, we are classifying and we do not need the consequent centroids.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">):</span>
                    <span class="n">consequent_ix</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">consequent</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids_rules</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids</span><span class="p">[</span><span class="n">consequent_ix</span><span class="p">]</span></div>



<div class="viewcode-block" id="RuleBaseT2.inference">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseT2.inference">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">inference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the iv output of the t2 inference system.</span>

<span class="sd">        Return an array in shape samples x 2 (last is iv dimension)</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :return: array with the memberships of the consequents for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>

        <span class="n">antecedent_memberships</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_rule_antecedent_memberships</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">antecedent_memberships</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">sample</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">centroid</span><span class="o">.</span><span class="n">consequent_centroid</span><span class="p">(</span>
                <span class="n">antecedent_memberships</span><span class="p">[</span><span class="n">sample</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids_rules</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="RuleBaseT2.forward">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseT2.forward">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the deffuzified output of the t2 inference system.</span>

<span class="sd">        Return a vector of size (samples, )</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :return: array with the deffuzified output for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inference</span><span class="p">(</span><span class="n">x</span><span class="p">))</span></div>



<div class="viewcode-block" id="RuleBaseT2.fuzzy_type">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseT2.fuzzy_type">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">fuzzy_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the correspoing type of the RuleBase using the enum type in the fuzzy_sets module.</span>

<span class="sd">        :return: the corresponding fuzzy set type of the RuleBase.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span></div>
</div>



<div class="viewcode-block" id="RuleBaseGT2">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseGT2">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">RuleBaseGT2</span><span class="p">(</span><span class="n">RuleBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class optimized to work with multiple rules at the same time. Supports only one consequent. </span>
<span class="sd">    (Use one rulebase per consequent to study classification problems. Check MasterRuleBase class for more documentation)</span>

<span class="sd">    This class supports gt2 fs. (ONLY FOR CLASSIFICATION PROBLEMS)</span>
<span class="sd">    &#39;&#39;&#39;</span>

<div class="viewcode-block" id="RuleBaseGT2.__init__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseGT2.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">antecedents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="p">],</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">RuleSimple</span><span class="p">],</span> <span class="n">consequent</span><span class="p">:</span> <span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tnorm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Constructor of the RuleBaseGT2 class.</span>

<span class="sd">        :param antecedents: list of fuzzy variables that are the antecedents of the rules.</span>
<span class="sd">        :param rules: list of rules.</span>
<span class="sd">        :param consequent: fuzzy variable that is the consequent of the rules.</span>
<span class="sd">        :param tnorm: t-norm used to compute the fuzzy output.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">rules</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_rule_duplicates</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules</span> <span class="o">=</span> <span class="n">rules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">=</span> <span class="n">antecedents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="o">=</span> <span class="n">consequent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tnorm</span> <span class="o">=</span> <span class="n">tnorm</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span> <span class="o">=</span> <span class="n">antecedents</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">alpha_cuts</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># We try to get the modifiers from the rules, else, we will use the ones given in the constructor.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_modifiers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">rule</span><span class="o">.</span><span class="n">modifiers</span> <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">rules</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_modifier</span> <span class="o">=</span> <span class="n">fuzzy_modifiers</span></div>



<div class="viewcode-block" id="RuleBaseGT2.inference">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseGT2.inference">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">inference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the output of the gt2 inference system.</span>

<span class="sd">        Return an array in shape samples x alpha_cuts</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :return: array with the memberships of the consequents for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>

        <span class="n">antecedent_memberships</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_rule_antecedent_memberships</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">antecedent_memberships</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">sample</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">centroid</span><span class="o">.</span><span class="n">consequent_centroid</span><span class="p">(</span>
                <span class="n">antecedent_memberships</span><span class="p">[</span><span class="n">sample</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids_rules</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">res</span></div>



    <span class="k">def</span><span class="w"> </span><span class="nf">_alpha_reduction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the type reduction to reduce the alpha cuts to one value.</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :return: array with the memberships of the consequents for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">formtatted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">formtatted</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span><span class="p">)</span>


<div class="viewcode-block" id="RuleBaseGT2.forward">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseGT2.forward">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the deffuzified output of the t2 inference system.</span>

<span class="sd">        Return a vector of size (samples, )</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :return: array with the deffuzified output for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inference</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span><span class="p">)</span></div>



<div class="viewcode-block" id="RuleBaseGT2.fuzzy_type">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseGT2.fuzzy_type">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">fuzzy_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the correspoing type of the RuleBase using the enum type in the fuzzy_sets module.</span>

<span class="sd">        :return: the corresponding fuzzy set type of the RuleBase.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">gt2</span></div>



<div class="viewcode-block" id="RuleBaseGT2.compute_rule_antecedent_memberships">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseGT2.compute_rule_antecedent_memberships">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_rule_antecedent_memberships</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">antecedents_memberships</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the membership for the antecedents performing the alpha_cut reduction.</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :param scaled: if True, the memberships are scaled to sum 1 in each sample.</span>
<span class="sd">        :param antecedents_memberships: precomputed antecedent memberships. Not supported for GT2.</span>
<span class="sd">        :return: array with the memberships of the antecedents for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">rules_truth_values</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">compute_rule_antecedent_memberships</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scaled</span><span class="p">,</span> <span class="n">antecedents_memberships</span><span class="o">=</span><span class="n">antecedents_memberships</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alpha_reduction</span><span class="p">(</span><span class="n">rules_truth_values</span><span class="p">)</span></div>



<div class="viewcode-block" id="RuleBaseGT2.alpha_compute_rule_antecedent_memberships">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseGT2.alpha_compute_rule_antecedent_memberships">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">alpha_compute_rule_antecedent_memberships</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">antecedents_memberships</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the membership for the antecedents for all the alpha cuts.</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :param scaled: if True, the memberships are scaled to sum 1 in each sample.</span>
<span class="sd">        :param antecedents_memberships: precomputed antecedent memberships. Not supported for GT2.</span>
<span class="sd">        :return: array with the memberships of the antecedents for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">compute_rule_antecedent_memberships</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scaled</span><span class="p">)</span></div>
</div>




<div class="viewcode-block" id="RuleBaseT1">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseT1">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">RuleBaseT1</span><span class="p">(</span><span class="n">RuleBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class optimized to work with multiple rules at the same time. Supports only one consequent.</span>
<span class="sd">    (Use one rulebase per consequent to study classification problems. Check MasterRuleBase class for more documentation)</span>

<span class="sd">    This class supports t1 fs.</span>
<span class="sd">    &#39;&#39;&#39;</span>

<div class="viewcode-block" id="RuleBaseT1.__init__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseT1.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">antecedents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="p">],</span> <span class="n">rules</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">RuleSimple</span><span class="p">],</span> <span class="n">consequent</span><span class="p">:</span> <span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">tnorm</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Constructor of the RuleBaseT1 class.</span>

<span class="sd">        :param antecedents: list of fuzzy variables that are the antecedents of the rules.</span>
<span class="sd">        :param rules: list of rules.</span>
<span class="sd">        :param consequent: fuzzy variable that is the consequent of the rules. ONLY on regression problems.</span>
<span class="sd">        :param tnorm: t-norm used to compute the fuzzy output.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">rules</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">delete_rule_duplicates</span><span class="p">(</span><span class="n">rules</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rules</span> <span class="o">=</span> <span class="n">rules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">=</span> <span class="n">antecedents</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consequent</span> <span class="o">=</span> <span class="n">consequent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tnorm</span> <span class="o">=</span> <span class="n">tnorm</span>

        <span class="k">if</span> <span class="n">consequent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">consequent</span><span class="o">.</span><span class="n">linguistic_variable_names</span><span class="p">()),</span> <span class="p">))</span>

            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">vl_consequent</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">consequent</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">):</span>
                <span class="n">consequent_domain</span> <span class="o">=</span> <span class="n">vl_consequent</span><span class="o">.</span><span class="n">domain</span>
                <span class="n">domain_linspace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
                    <span class="n">consequent_domain</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">consequent_domain</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.05</span><span class="p">)</span>
                <span class="n">consequent_memberships</span> <span class="o">=</span> <span class="n">vl_consequent</span><span class="o">.</span><span class="n">membership</span><span class="p">(</span>
                    <span class="n">domain_linspace</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">centroid</span><span class="o">.</span><span class="n">center_of_masses</span><span class="p">(</span>
                    <span class="n">domain_linspace</span><span class="p">,</span> <span class="n">consequent_memberships</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids_rules</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">),</span> <span class="p">))</span>
            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rules</span><span class="p">):</span>
                <span class="n">consequent_ix</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">consequent</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids_rules</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids</span><span class="p">[</span><span class="n">consequent_ix</span><span class="p">]</span></div>



<div class="viewcode-block" id="RuleBaseT1.inference">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseT1.inference">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">inference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the output of the t1 inference system.</span>

<span class="sd">        Return an array in shape samples.</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :return: array with the output of the inference system for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="n">antecedent_memberships</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_rule_antecedent_memberships</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">antecedent_memberships</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">sample</span><span class="p">]</span> <span class="o">=</span> <span class="n">centroid</span><span class="o">.</span><span class="n">center_of_masses</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">consequent_centroids_rules</span><span class="p">,</span> <span class="n">antecedent_memberships</span><span class="p">[</span><span class="n">sample</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">res</span></div>


<div class="viewcode-block" id="RuleBaseT1.forward">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseT1.forward">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Same as inference() in the t1 case.</span>

<span class="sd">        Return a vector of size (samples, )</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :return: array with the deffuzified output for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inference</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>



<div class="viewcode-block" id="RuleBaseT1.fuzzy_type">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.RuleBaseT1.fuzzy_type">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">fuzzy_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the correspoing type of the RuleBase using the enum type in the fuzzy_sets module.</span>

<span class="sd">        :return: the corresponding fuzzy set type of the RuleBase.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span></div>
</div>




<div class="viewcode-block" id="MasterRuleBase">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">MasterRuleBase</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This Class encompasses a list of rule bases where each one corresponds to a different class.</span>
<span class="sd">    &#39;&#39;&#39;</span>

<div class="viewcode-block" id="MasterRuleBase.__init__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule_base</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">RuleBase</span><span class="p">],</span> <span class="n">consequent_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ds_mode</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">allow_unknown</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Constructor of the MasterRuleBase class.</span>

<span class="sd">        :param rule_base: list of rule bases.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rule_base</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RuleError</span><span class="p">(</span><span class="s1">&#39;No rule bases given!&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span> <span class="o">=</span> <span class="n">rule_base</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span> <span class="o">=</span> <span class="n">rule_base</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">antecedents</span>

        <span class="k">if</span> <span class="n">consequent_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">consequent_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">ix</span> <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">))]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">consequent_names</span> <span class="o">=</span> <span class="n">consequent_names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ds_mode</span> <span class="o">=</span> <span class="n">ds_mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_unknown</span> <span class="o">=</span> <span class="n">allow_unknown</span></div>



<div class="viewcode-block" id="MasterRuleBase.rename_cons">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.rename_cons">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">rename_cons</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">consequent_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Renames the consequents of the rule base.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">consequent_names</span> <span class="o">=</span> <span class="n">consequent_names</span></div>



<div class="viewcode-block" id="MasterRuleBase.add_rule">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.add_rule">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_rule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule</span><span class="p">:</span> <span class="n">RuleSimple</span><span class="p">,</span> <span class="n">consequent</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Adds a rule to the rule base of the given consequent.</span>

<span class="sd">        :param rule: rule to add.</span>
<span class="sd">        :param consequent: index of the rule base to add the rule.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">[</span><span class="n">consequent</span><span class="p">]</span><span class="o">.</span><span class="n">add_rule</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span></div>

    

<div class="viewcode-block" id="MasterRuleBase.get_consequents">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.get_consequents">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_consequents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a list with the consequents of each rule base.</span>

<span class="sd">        :return: list with the consequents of each rule base.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">([[</span><span class="n">ix</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">)],</span> <span class="p">[])</span></div>



<div class="viewcode-block" id="MasterRuleBase.get_consequents_names">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.get_consequents_names">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_consequents_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a list with the names of the consequents.</span>

<span class="sd">        :return: list with the names of the consequents.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent_names</span></div>

    

<div class="viewcode-block" id="MasterRuleBase.get_rulebase_matrix">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.get_rulebase_matrix">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_rulebase_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a list with the rulebases for each antecedent in matrix format.</span>

<span class="sd">        :return: list with the rulebases for each antecedent in matrix format.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">get_rulebase_matrix</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">]</span></div>



<div class="viewcode-block" id="MasterRuleBase.get_scores">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.get_scores">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the dominance score for each rule in all the rulebases.</span>

<span class="sd">        :return: array with the dominance score for each rule in all the rulebases.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">scores</span><span class="p">())</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">res</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>

    

<div class="viewcode-block" id="MasterRuleBase.get_weights">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.get_weights">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the weights for each rule in all the rulebases.</span>

<span class="sd">        :return: array with the weights for each rule in all the rulebases.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">rb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rb</span><span class="o">.</span><span class="n">get_weights</span><span class="p">())</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">res</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span></div>



<div class="viewcode-block" id="MasterRuleBase.compute_firing_strenghts">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.compute_firing_strenghts">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_firing_strenghts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">precomputed_truth</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the firing strength of each rule for each sample.</span>

<span class="sd">        :param X: array with the values of the inputs.</span>
<span class="sd">        :param precomputed_truth: if not None, the antecedent memberships are already computed. (Used for sped up in genetic algorithms)</span>
<span class="sd">        :return: array with the firing strength of each rule for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">)):</span>
            <span class="n">aux</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">compute_rule_antecedent_memberships</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">antecedents_memberships</span><span class="o">=</span><span class="n">precomputed_truth</span><span class="p">))</span>

        <span class="c1"># Firing strengths shape: samples x rules (x 2) (last is iv dimension) or (x alpha_cuts x 2) for gt2</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">aux</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>



    <span class="k">def</span><span class="w"> </span><span class="nf">_winning_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">precomputed_truth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_unkown</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
        <span class="n">association_degrees</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_association_degrees</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">precomputed_truth</span><span class="p">)</span>
        <span class="n">firing_strengths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_firing_strenghts</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">precomputed_truth</span><span class="o">=</span><span class="n">precomputed_truth</span><span class="p">)</span>

        <span class="n">winning_rules</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">association_degrees</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">winning_association_degrees</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">firing_strengths</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">allow_unkown</span><span class="p">:</span>
            <span class="c1"># If there is no rule that fires, we set the consequent to -1</span>
            <span class="n">winning_rules</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">association_degrees</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">return</span> <span class="n">winning_rules</span><span class="p">,</span> <span class="n">winning_association_degrees</span>


<div class="viewcode-block" id="MasterRuleBase.compute_association_degrees">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.compute_association_degrees">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_association_degrees</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">precomputed_truth</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the winning rule for each sample. Takes into account dominance scores if already computed.</span>
<span class="sd">        :param X: array with the values of the inputs.</span>
<span class="sd">        :return: array with the winning rule for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">firing_strengths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_firing_strenghts</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">precomputed_truth</span><span class="o">=</span><span class="n">precomputed_truth</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds_mode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">rulesw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_scores</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">rulesw</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">rulesw</span> <span class="o">=</span> <span class="n">rulesw</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">]</span>
                
            <span class="n">association_degrees</span> <span class="o">=</span> <span class="n">rulesw</span> <span class="o">*</span> <span class="n">firing_strengths</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds_mode</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">association_degrees</span> <span class="o">=</span> <span class="n">firing_strengths</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ds_mode</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">rulesw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_weights</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span><span class="p">:</span>
                <span class="n">rulesw</span> <span class="o">=</span> <span class="n">rulesw</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="kc">None</span><span class="p">]</span> 
            
            <span class="n">association_degrees</span> <span class="o">=</span> <span class="n">rulesw</span> <span class="o">*</span> <span class="n">firing_strengths</span>

        <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">gt2</span><span class="p">):</span>
            <span class="n">association_degrees</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">association_degrees</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">gt2</span><span class="p">:</span>
            <span class="n">association_degrees</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">association_degrees</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">association_degrees</span></div>

    
    
<div class="viewcode-block" id="MasterRuleBase.winning_rule_predict">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.winning_rule_predict">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">winning_rule_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">precomputed_truth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_class_names</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the winning rule for each sample. Takes into account dominance scores if already computed.</span>

<span class="sd">        :param X: array with the values of the inputs.</span>
<span class="sd">        :param precomputed_truth: if not None, the antecedent memberships are already computed. (Used for sped up in genetic algorithms)</span>
<span class="sd">        :return: array with the winning rule for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Raise an error if there no rules</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rules</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RuleError</span><span class="p">(</span><span class="s1">&#39;No rules to predict!&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">out_class_names</span><span class="p">:</span>
            <span class="n">consequents</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([[</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent_names</span><span class="p">[</span><span class="n">ix</span><span class="p">]]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">))],</span> <span class="p">[])</span>  <span class="c1"># The sum is for flatenning the list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">consequents</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([[</span><span class="n">ix</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">))],</span> <span class="p">[])</span>  <span class="c1"># The sum is for flatenning the list</span>
            
        <span class="n">winning_rules</span><span class="p">,</span> <span class="n">_winning_association_degrees</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_winning_rules</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">precomputed_truth</span><span class="o">=</span><span class="n">precomputed_truth</span><span class="p">,</span> <span class="n">allow_unkown</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_unknown</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">out_class_names</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">))</span>

        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">winning_rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">winning_rules</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">winning_rule</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">out_class_names</span><span class="p">:</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">consequents</span><span class="p">[</span><span class="n">winning_rule</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">consequents</span><span class="p">[</span><span class="n">winning_rule</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">out_class_names</span><span class="p">:</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>



<div class="viewcode-block" id="MasterRuleBase.explainable_predict">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.explainable_predict">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">explainable_predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">out_class_names</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">precomputed_truth</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the predicted class for each sample.</span>

<span class="sd">        :param X: array with the values of the inputs.</span>
<span class="sd">        :param out_class_names: if True, the output will be the class names instead of the class index.</span>
<span class="sd">        :return: np array samples (x 1) with the predicted class.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># Raise an error if there no rules</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_rules</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">RuleError</span><span class="p">(</span><span class="s1">&#39;No rules to predict!&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">out_class_names</span><span class="p">:</span>
            <span class="n">consequents</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([[</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent_names</span><span class="p">[</span><span class="n">ix</span><span class="p">]]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">))],</span> <span class="p">[])</span>  <span class="c1"># The sum is for flatenning the list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">consequents</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([[</span><span class="n">ix</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">rules</span><span class="p">)</span>
                          <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">))],</span> <span class="p">[])</span>  <span class="c1"># The sum is for flatenning the list</span>
            
        <span class="n">winning_rules</span><span class="p">,</span> <span class="n">winning_association_degrees</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_winning_rules</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">precomputed_truth</span><span class="o">=</span><span class="n">precomputed_truth</span><span class="p">,</span> <span class="n">allow_unkown</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_unknown</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">confidence_intervals</span> <span class="o">=</span> <span class="p">[</span> <span class="n">rule</span><span class="o">.</span><span class="n">boot_confidence_interval</span> <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_rules</span><span class="p">()]</span>
            <span class="n">winning_rule_confidence_intervals</span> <span class="o">=</span> <span class="p">[</span><span class="n">confidence_intervals</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="n">winning_rules</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">winning_rule_confidence_intervals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">out_class_names</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">))</span>

        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">winning_rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">winning_rules</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">winning_rule</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">out_class_names</span><span class="p">:</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">consequents</span><span class="p">[</span><span class="n">winning_rule</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">consequents</span><span class="p">[</span><span class="n">winning_rule</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">out_class_names</span><span class="p">:</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">winning_association_degrees</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">winning_association_degrees</span> <span class="o">=</span> <span class="n">winning_association_degrees</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">winning_rules</span><span class="p">,</span> <span class="n">winning_association_degrees</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">winning_rule_confidence_intervals</span><span class="p">)</span> <span class="o">*</span> <span class="n">winning_association_degrees</span></div>




<div class="viewcode-block" id="MasterRuleBase.add_rule_base">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.add_rule_base">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_rule_base</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule_base</span><span class="p">:</span> <span class="n">RuleBase</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Adds a rule base to the list of rule bases.</span>


<span class="sd">        :param rule_base: rule base to add.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rule_base</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent_names</span><span class="p">):</span>
            <span class="c1"># We did not give proper names to the consequents</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">consequent_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">ix</span> <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">))]</span></div>



<div class="viewcode-block" id="MasterRuleBase.print_rules">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.print_rules">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_rules</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bootstrap_results</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Print all the rules for all the consequents.</span>

<span class="sd">        :param autoprint: if True, the rules are printed. If False, the rules are returned as a string.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
         
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">ruleBase</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">):</span>    
            <span class="n">res</span> <span class="o">+=</span> <span class="s1">&#39;Rules for consequent: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent_names</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="s1">&#39;----------------</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="n">ruleBase</span><span class="o">.</span><span class="n">print_rules</span><span class="p">(</span><span class="n">return_rules</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap_results</span><span class="o">=</span><span class="n">bootstrap_results</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
        
        
        <span class="k">if</span> <span class="n">return_rules</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">res</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>

    

<div class="viewcode-block" id="MasterRuleBase.print_rule_bootstrap_results">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.print_rule_bootstrap_results">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_rule_bootstrap_results</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Prints the bootstrap results for each rule.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">ruleBase</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Rules for consequent: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent_names</span><span class="p">[</span><span class="n">ix</span><span class="p">]))</span>
            <span class="n">ruleBase</span><span class="o">.</span><span class="n">print_rule_bootstrap_results</span><span class="p">()</span></div>



<div class="viewcode-block" id="MasterRuleBase.get_rules">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.get_rules">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">RuleSimple</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a list with all the rules.</span>

<span class="sd">        :return: list with all the rules.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">rule</span> <span class="k">for</span> <span class="n">ruleBase</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span> <span class="k">for</span> <span class="n">rule</span> <span class="ow">in</span> <span class="n">ruleBase</span><span class="o">.</span><span class="n">rules</span><span class="p">]</span></div>



<div class="viewcode-block" id="MasterRuleBase.fuzzy_type">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.fuzzy_type">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">fuzzy_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the correspoing type of the RuleBase using the enum type in the fuzzy_sets module.</span>

<span class="sd">        :return: the corresponding fuzzy set type of the RuleBase.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span></div>



<div class="viewcode-block" id="MasterRuleBase.purge_rules">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.purge_rules">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">purge_rules</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Delete the roles with a dominance score lower than the tolerance.</span>

<span class="sd">        :param tolerance: tolerance to delete the rules.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">ruleBase</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">:</span>
            <span class="n">ruleBase</span><span class="o">.</span><span class="n">prune_bad_rules</span><span class="p">(</span><span class="n">tolerance</span><span class="p">)</span></div>



<div class="viewcode-block" id="MasterRuleBase.__getitem__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.__getitem__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RuleBase</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the corresponding rulebase.</span>

<span class="sd">        :param item: index of the rulebase.</span>
<span class="sd">        :return: the corresponding rulebase.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">[</span><span class="n">item</span><span class="p">]</span></div>



<div class="viewcode-block" id="MasterRuleBase.__len__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.__len__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the number of rule bases.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">)</span></div>



<div class="viewcode-block" id="MasterRuleBase.__str__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.__str__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a string with the rules for each consequent.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_rules</span><span class="p">(</span><span class="n">return_rules</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bootstrap_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

    

<div class="viewcode-block" id="MasterRuleBase.__eq__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.__eq__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__value</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns True if the two rule bases are equal.</span>

<span class="sd">        :param __value: object to compare.</span>
<span class="sd">        :return: True if the two rule bases are equal.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">__value</span><span class="p">,</span> <span class="n">MasterRuleBase</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span> <span class="o">==</span> <span class="n">__value</span><span class="o">.</span><span class="n">rule_bases</span></div>

        
    
<div class="viewcode-block" id="MasterRuleBase.__call__">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.__call__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Gives the prediction for each sample (same as winning_rule_predict)</span>

<span class="sd">        :param X: array of dims: samples x features.</span>
<span class="sd">        :return: vector of predictions, size: samples,</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">winning_rule_predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
         
        <span class="c1"># Convert the predictions to the names of the consequents</span>
        <span class="c1">#return np.array(self.consequent_names)[aux]</span>
        <span class="k">return</span> <span class="n">aux</span></div>

    

<div class="viewcode-block" id="MasterRuleBase.predict">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.predict">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Gives the prediction for each sample (same as winning_rule_predict)</span>

<span class="sd">        :param X: array of dims: samples x features.</span>
<span class="sd">        :return: vector of predictions, size: samples,</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="n">X</span><span class="p">)</span></div>

        

<div class="viewcode-block" id="MasterRuleBase.get_rulebases">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.get_rulebases">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_rulebases</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">RuleBase</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns a list with all the rules.</span>

<span class="sd">        :return: list</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span></div>



<div class="viewcode-block" id="MasterRuleBase.n_linguistic_variables">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.n_linguistic_variables">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">n_linguistic_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the number of linguistic variables in the rule base.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">amt</span><span class="p">)</span> <span class="k">for</span> <span class="n">amt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span><span class="p">]</span></div>

    

<div class="viewcode-block" id="MasterRuleBase.get_antecedents">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.get_antecedents">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_antecedents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the antecedents of the rule base.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">antecedents</span></div>

    
    <span class="c1"># Add to MasterRuleBase class</span>
<div class="viewcode-block" id="MasterRuleBase.copy">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.MasterRuleBase.copy">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creates a copy of the MasterRuleBase.</span>
<span class="sd">        </span>
<span class="sd">        :param deep: if True, creates a deep copy. If False, creates a shallow copy.</span>
<span class="sd">        :return: a copy of the MasterRuleBase.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">deep</span><span class="p">:</span>
            <span class="c1"># Deep copy all rule bases and other attributes</span>
            <span class="n">copied_rule_bases</span> <span class="o">=</span> <span class="p">[</span><span class="n">rb</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">rb</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">]</span>
            <span class="n">copied_consequent_names</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">consequent_names</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Shallow copy - copy the list but not the rule bases themselves</span>
            <span class="n">copied_rule_bases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">copied_consequent_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">consequent_names</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        
        <span class="c1"># Create new MasterRuleBase instance</span>
        <span class="n">new_master_rb</span> <span class="o">=</span> <span class="n">MasterRuleBase</span><span class="p">(</span>
            <span class="n">copied_rule_bases</span><span class="p">,</span> 
            <span class="n">copied_consequent_names</span><span class="p">,</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">ds_mode</span><span class="p">,</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">allow_unknown</span>
        <span class="p">)</span>
        
        <span class="k">return</span> <span class="n">new_master_rb</span></div>
</div>



<div class="viewcode-block" id="construct_rule_base">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.construct_rule_base">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">construct_rule_base</span><span class="p">(</span><span class="n">rule_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">nclasses</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">consequents</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">antecedents</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="p">],</span> <span class="n">rule_weights</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">class_names</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MasterRuleBase</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Constructs a rule base from a matrix of rules.</span>

<span class="sd">    :param rule_matrix: matrix with the rules.</span>
<span class="sd">    :param consequents: array with the consequents per rule.</span>
<span class="sd">    :param antecedents: list of fuzzy variables.</span>
<span class="sd">    :param class_names: list with the names of the classes.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">rule_lists</span> <span class="o">=</span> <span class="p">{</span><span class="n">ix</span><span class="p">:[]</span> <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nclasses</span><span class="p">)}</span>
    <span class="n">fs_studied</span> <span class="o">=</span> <span class="n">antecedents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">consequent</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">consequents</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">rule_matrix</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">():</span>
            <span class="n">rule_object</span> <span class="o">=</span> <span class="n">RuleSimple</span><span class="p">(</span><span class="n">rule_matrix</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
            <span class="n">rule_object</span><span class="o">.</span><span class="n">score</span> <span class="o">=</span> <span class="n">rule_weights</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
            <span class="n">rule_lists</span><span class="p">[</span><span class="n">consequent</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rule_object</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">consequent</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">consequents</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">fs_studied</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">:</span>
            <span class="n">rule_base</span> <span class="o">=</span> <span class="n">RuleBaseT1</span><span class="p">(</span><span class="n">antecedents</span><span class="p">,</span> <span class="n">rule_lists</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">fs_studied</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span><span class="p">:</span>
            <span class="n">rule_base</span> <span class="o">=</span> <span class="n">RuleBaseT2</span><span class="p">(</span><span class="n">antecedents</span><span class="p">,</span> <span class="n">rule_lists</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">fs_studied</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">gt2</span><span class="p">:</span>
            <span class="n">rule_base</span> <span class="o">=</span> <span class="n">RuleBaseGT2</span><span class="p">(</span><span class="n">antecedents</span><span class="p">,</span> <span class="n">rule_lists</span><span class="p">[</span><span class="n">ix</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">MasterRuleBase</span><span class="p">([</span><span class="n">rule_base</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">consequents</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">add_rule_base</span><span class="p">(</span><span class="n">rule_base</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">class_names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">rename_cons</span><span class="p">(</span><span class="n">class_names</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="list_rules_to_matrix">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.list_rules_to_matrix">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">list_rules_to_matrix</span><span class="p">(</span><span class="n">rule_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">RuleSimple</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns a matrix out of the rule list.</span>

<span class="sd">    :param rule_list: list of rules.</span>
<span class="sd">    :return: matrix with the antecedents of the rules.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">rule_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;No rules to list!&#39;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">rule_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">rule_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">antecedents</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rule_list</span><span class="p">):</span>
        <span class="n">res</span><span class="p">[</span><span class="n">ix</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">antecedents</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="generate_rule_string">
<a class="viewcode-back" href="../../function_resume/rules.html#ex_fuzzy.rules.generate_rule_string">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">generate_rule_string</span><span class="p">(</span><span class="n">rule</span><span class="p">:</span> <span class="n">RuleSimple</span><span class="p">,</span> <span class="n">antecedents</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">bootstrap_results</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Generates a string with the rule.</span>

<span class="sd">    :param rule: rule to generate the string.</span>
<span class="sd">    :param antecedents: list of fuzzy variables.</span>
<span class="sd">    :param modifiers: array with the modifiers for the antecedents.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">format_p_value</span><span class="p">(</span><span class="n">p_value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;***&#39;</span>
        <span class="k">elif</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;**&#39;</span> 
        <span class="k">elif</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;*&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;ns&#39;</span>
        
    <span class="n">initiated</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">str_rule</span> <span class="o">=</span> <span class="s1">&#39;IF &#39;</span>
    <span class="k">for</span> <span class="n">jx</span><span class="p">,</span> <span class="n">antecedent</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">antecedents</span><span class="p">):</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="n">antecedent</span><span class="o">.</span><span class="n">linguistic_variable_names</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">rule</span><span class="p">[</span><span class="n">jx</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">initiated</span><span class="p">:</span>
                <span class="n">initiated</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">str_rule</span> <span class="o">+=</span> <span class="s1">&#39; AND &#39;</span>

            <span class="n">str_rule</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">antecedent</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; IS &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">keys</span><span class="p">[</span><span class="n">rule</span><span class="p">[</span><span class="n">jx</span><span class="p">]])</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">relevant_modifier</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">modifiers</span><span class="p">[</span><span class="n">jx</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">relevant_modifier</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">relevant_modifier</span> <span class="ow">in</span> <span class="n">modifiers_names</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">str_mod</span> <span class="o">=</span> <span class="n">modifiers_names</span><span class="p">[</span><span class="n">relevant_modifier</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">str_mod</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">relevant_modifier</span><span class="p">)</span>

                    <span class="n">str_rule</span> <span class="o">+=</span> <span class="s1">&#39; (MOD &#39;</span> <span class="o">+</span> <span class="n">str_mod</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">pass</span>


    <span class="k">try</span><span class="p">:</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">score</span> <span class="k">if</span> <span class="n">antecedents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span> <span class="o">==</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
        <span class="n">str_rule</span> <span class="o">+=</span> <span class="s1">&#39; WITH DS &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>

        <span class="c1"># If the classification scores have been computed, print them.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">str_rule</span> <span class="o">+=</span> <span class="s1">&#39;, ACC &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">accuracy</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="c1"># Check if they have weights</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">str_rule</span> <span class="o">+=</span> <span class="s1">&#39;, WGHT &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">str_rule</span> <span class="o">+=</span> <span class="s1">&#39; THEN consequent vl is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">consequent</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
    
    <span class="k">if</span> <span class="n">bootstrap_results</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">p_value_class_structure</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">p_value_class_structure</span>
            <span class="n">p_value_feature_coalition</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">p_value_feature_coalitions</span>


            <span class="n">pvc</span> <span class="o">=</span> <span class="n">format_p_value</span><span class="p">(</span><span class="n">p_value_class_structure</span><span class="p">)</span>
            <span class="n">pvf</span> <span class="o">=</span> <span class="n">format_p_value</span><span class="p">(</span><span class="n">p_value_feature_coalition</span><span class="p">)</span>

            <span class="n">str_rule</span> <span class="o">+=</span> <span class="s1">&#39; (p-value Permutation Class Structure: &#39;</span> <span class="o">+</span> <span class="n">pvc</span> <span class="o">+</span> <span class="s1">&#39;, Feature Coalition: &#39;</span> <span class="o">+</span> <span class="n">pvf</span> 
            <span class="n">p_value_bootstrap</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">boot_p_value</span>

            <span class="n">pbs</span> <span class="o">=</span> <span class="n">format_p_value</span><span class="p">(</span><span class="n">p_value_bootstrap</span><span class="p">)</span>
            <span class="n">str_rule</span> <span class="o">+=</span> <span class="s1">&#39; Membership Validation: &#39;</span> <span class="o">+</span> <span class="n">pbs</span>
            <span class="n">str_rule</span> <span class="o">+=</span> <span class="s1">&#39;)&#39;</span>

            <span class="n">str_rule</span> <span class="o">+=</span> <span class="s1">&#39; Confidence Interval: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">boot_confidence_interval</span><span class="p">)</span>
            <span class="n">str_rule</span> <span class="o">+=</span> <span class="s1">&#39; Support Interval: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="o">.</span><span class="n">boot_support_interval</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>
    <span class="k">return</span> <span class="n">str_rule</span></div>

</pre></div>

                </article>
              
              
              
              
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2023-2025, Javier Fumanal Idocin.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>