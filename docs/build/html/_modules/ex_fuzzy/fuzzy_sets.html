
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ex_fuzzy.fuzzy_sets &#8212; Ex-Fuzzy 1.0.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=edfbbfd1" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=30646c52"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/ex_fuzzy/fuzzy_sets';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="1.0.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs..."
         aria-label="Search the docs..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">Ex-Fuzzy</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API Reference
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../evox_backend.html">
    EvoX Backend Guide
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../changelog.html">
    Changelog
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../contributing.html">
    Contributing
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../roadmap.html">
    Roadmap
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../api.html">
    Legacy API Summary
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../usage.html">
    Getting Started
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../step1.html">
    Creating fuzzy sets and fuzzy variables
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../step2.html">
    Using Fuzzy Rules
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../step3.html">
    Optimizing a Fuzzy rule base for a classification problem
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../step4.html">
    Visualize rules and results
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../precom.html">
    Computing fuzzy partitions
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../optimize.html">
    Genetic algorithm details
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../gt2.html">
    General Type 2
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../tmpfs.html">
    Temporal Fuzzy Sets
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../extending.html">
    Extending Ex-Fuzzy
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../classifiers.html">
    Advanced classifiers
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../pattern_stats.html">
    Bootstrapping and rule robustness
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/fuminides/ex-fuzzy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/ex-fuzzy/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../evox_backend.html">
    EvoX Backend Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../changelog.html">
    Changelog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../roadmap.html">
    Roadmap
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api.html">
    Legacy API Summary
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../usage.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../step1.html">
    Creating fuzzy sets and fuzzy variables
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../step2.html">
    Using Fuzzy Rules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../step3.html">
    Optimizing a Fuzzy rule base for a classification problem
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../step4.html">
    Visualize rules and results
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../precom.html">
    Computing fuzzy partitions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../optimize.html">
    Genetic algorithm details
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../gt2.html">
    General Type 2
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tmpfs.html">
    Temporal Fuzzy Sets
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../extending.html">
    Extending Ex-Fuzzy
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../classifiers.html">
    Advanced classifiers
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../pattern_stats.html">
    Bootstrapping and rule robustness
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/fuminides/ex-fuzzy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/ex-fuzzy/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Module code</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">ex_fuzzy.fuzzy_sets</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>Source code for ex_fuzzy.fuzzy_sets</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Fuzzy Sets Module for Ex-Fuzzy Library</span>

<span class="sd">This module contains the core fuzzy set classes and functionality for the ex-fuzzy library.</span>
<span class="sd">It implements Type-1, Type-2, and General Type-2 fuzzy sets with their associated </span>
<span class="sd">membership functions and operations.</span>

<span class="sd">Main Components:</span>
<span class="sd">    - FUZZY_SETS enum: Defines the types of fuzzy sets supported</span>
<span class="sd">    - Membership function implementations (trapezoidal, triangular, gaussian)</span>
<span class="sd">    - Fuzzy set classes: FS, IVFS, gaussianFS, gaussianIVFS, categoricalFS, etc.</span>
<span class="sd">    - fuzzyVariable class: Container for linguistic variables with multiple fuzzy sets</span>
<span class="sd">    - Validation and statistical testing methods for fuzzy variables</span>

<span class="sd">The module supports both numerical computation and provides interfaces for</span>
<span class="sd">PyTorch tensors when available, making it suitable for both traditional fuzzy</span>
<span class="sd">logic applications and modern machine learning workflows.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">enum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Generator</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="k">try</span><span class="p">:</span>
    <span class="k">pass</span>  <span class="c1"># Removed deprecated maintenance module</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">pass</span>

<span class="c1"># You dont require torch to use this module, however, we need to import it to give support in case you feed these methods with torch tensors.</span>
<span class="c1"># Torch is imported lazily only when needed to avoid expensive imports</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_get_torch</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Lazy import of torch to avoid expensive imports when not needed.&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
        <span class="k">return</span> <span class="n">torch</span>
    <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span><span class="w"> </span><span class="nf">_is_torch_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if x is a torch tensor without importing torch unless necessary.&quot;&quot;&quot;</span>
    <span class="c1"># First check the type name to avoid torch import if not needed</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">!=</span> <span class="s1">&#39;Tensor&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    
    <span class="c1"># Only import torch if we have a potential tensor</span>
    <span class="n">torch</span> <span class="o">=</span> <span class="n">_get_torch</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">torch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    
    <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">FUZZY_SETS</span><span class="p">(</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enumeration defining the types of fuzzy sets supported by the library.</span>
<span class="sd">    </span>
<span class="sd">    This enum is used throughout the library to specify which type of fuzzy set</span>
<span class="sd">    should be created or used in operations.</span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        t1: Type-1 fuzzy sets with crisp membership functions</span>
<span class="sd">        t2: Type-2 interval fuzzy sets with upper and lower membership bounds  </span>
<span class="sd">        gt2: General Type-2 fuzzy sets with full secondary membership functions</span>
<span class="sd">        </span>
<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; fz_type = FUZZY_SETS.t1</span>
<span class="sd">        &gt;&gt;&gt; if fz_type == FUZZY_SETS.t1:</span>
<span class="sd">        ...     print(&quot;Using Type-1 fuzzy sets&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="s1">&#39;Type 1&#39;</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="s1">&#39;Type 2&#39;</span>
    <span class="n">gt2</span> <span class="o">=</span> <span class="s1">&#39;General Type 2&#39;</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">__value</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compare enum values based on their stored string value.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">__value</span><span class="o">.</span><span class="n">value</span>


<span class="k">def</span><span class="w"> </span><span class="nf">trapezoidal_membership</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">10E-5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute trapezoidal membership function values.</span>
<span class="sd">    </span>
<span class="sd">    This function computes the membership degree for input values using a trapezoidal</span>
<span class="sd">    membership function defined by four parameters representing the trapezoid vertices.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        x (np.array): Input values in the fuzzy set domain for which to compute membership</span>
<span class="sd">        params (list[float]): Four numbers [a, b, c, d] defining the trapezoid:</span>
<span class="sd">            - a: left foot (membership starts rising)</span>
<span class="sd">            - b: left shoulder (membership reaches 1.0)  </span>
<span class="sd">            - c: right shoulder (membership starts falling)</span>
<span class="sd">            - d: right foot (membership reaches 0.0)</span>
<span class="sd">        epsilon (float, optional): Small value for numerical stability. Defaults to 10E-5.</span>
<span class="sd">            </span>
<span class="sd">    Returns:</span>
<span class="sd">        np.array: Membership values in [0, 1] for each input value</span>
<span class="sd">        </span>
<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; x = np.array([0, 1, 2, 3, 4, 5])</span>
<span class="sd">        &gt;&gt;&gt; params = [1, 2, 3, 4]  # trapezoid from 1 to 4, flat from 2 to 3</span>
<span class="sd">        &gt;&gt;&gt; membership = trapezoidal_membership(x, params)</span>
<span class="sd">        &gt;&gt;&gt; print(membership)  # [0, 0, 1, 1, 0, 0]</span>
<span class="sd">        </span>
<span class="sd">    Note:</span>
<span class="sd">        Special case: if a == d (singleton), returns 1.0 for exact matches, 0.0 otherwise.</span>
<span class="sd">        This handles degenerate trapezoids that collapse to single points.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">params</span>

    <span class="c1"># Special case: a singleton trapezoid</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">==</span> <span class="n">d</span><span class="p">:</span>
        <span class="c1"># If they are numpy arrays, we need to use the numpy function</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_is_torch_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">torch</span> <span class="o">=</span> <span class="n">_get_torch</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
            

    <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="n">a</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">+=</span> <span class="n">epsilon</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="n">d</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">+=</span> <span class="n">epsilon</span>

    <span class="n">aux1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">aux2</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">_is_torch_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="n">torch</span> <span class="o">=</span> <span class="n">_get_torch</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">aux1</span><span class="p">,</span> <span class="n">aux2</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">aux1</span><span class="p">,</span> <span class="n">aux2</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>        
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">aux1</span><span class="p">,</span> <span class="n">aux2</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">aux1</span><span class="p">,</span> <span class="n">aux2</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1"># Single value</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">aux1</span><span class="p">,</span> <span class="n">aux2</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>



<span class="k">def</span><span class="w"> </span><span class="nf">_gaussian2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">params</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Gaussian membership functions.</span>

<span class="sd">    :param mean:  real number, mean of the gaussian function.</span>
<span class="sd">    :param amplitude: real number.</span>
<span class="sd">    :param standard_deviation: std of the gaussian function.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">standard_deviation</span> <span class="o">=</span> <span class="n">params</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">/</span> <span class="n">standard_deviation</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>


<div class="viewcode-block" id="FS">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.FS">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">FS</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for Type-1 fuzzy sets (Zadeh fuzzy sets).</span>
<span class="sd">    </span>
<span class="sd">    This class implements the fundamental Type-1 fuzzy set with crisp membership functions.</span>
<span class="sd">    It serves as the base class for more specialized fuzzy set types like triangular,</span>
<span class="sd">    gaussian, and categorical fuzzy sets.</span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        name (str): The linguistic name of the fuzzy set (e.g., &quot;low&quot;, &quot;medium&quot;, &quot;high&quot;)</span>
<span class="sd">        membership_parameters (list[float]): Parameters defining the membership function</span>
<span class="sd">        domain (list[float]): Two-element list defining the universe of discourse [min, max]</span>
<span class="sd">        </span>
<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; fs = FS(&quot;medium&quot;, [1, 2, 3, 4], [0, 5])  # Trapezoidal fuzzy set</span>
<span class="sd">        &gt;&gt;&gt; membership = fs.membership(2.5)</span>
<span class="sd">        &gt;&gt;&gt; print(membership)  # Should be 1.0 (fully in the set)</span>
<span class="sd">        </span>
<span class="sd">    Note:</span>
<span class="sd">        This class uses trapezoidal membership functions by default. For other shapes,</span>
<span class="sd">        use specialized subclasses like gaussianFS or triangularFS.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="FS.__init__">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.FS.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">membership_parameters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">domain</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a Type-1 fuzzy set.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): Linguistic name for the fuzzy set</span>
<span class="sd">            membership_parameters (list[float]): Four parameters [a, b, c, d] defining </span>
<span class="sd">                the trapezoidal membership function where:</span>
<span class="sd">                - a: left foot (membership starts rising from 0)</span>
<span class="sd">                - b: left shoulder (membership reaches 1.0)</span>
<span class="sd">                - c: right shoulder (membership starts falling from 1.0)</span>
<span class="sd">                - d: right foot (membership reaches 0)</span>
<span class="sd">            domain (list[float]): Two-element list [min, max] defining the universe</span>
<span class="sd">                of discourse for this fuzzy set</span>
<span class="sd">                </span>
<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; fs = FS(&quot;medium&quot;, [2, 3, 7, 8], [0, 10])</span>
<span class="sd">            &gt;&gt;&gt; # Creates a trapezoidal set: rises from 2-3, flat 3-7, falls 7-8</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="n">domain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">membership_parameters</span> <span class="o">=</span> <span class="n">membership_parameters</span></div>



<div class="viewcode-block" id="FS.membership">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.FS.membership">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">membership</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute membership degrees for input values.</span>

<span class="sd">        This method calculates the membership degree(s) for the given input value(s)</span>
<span class="sd">        using the trapezoidal membership function defined by this fuzzy set&#39;s parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            x (np.array): Input value(s) for which to compute membership degrees.</span>
<span class="sd">                Can be a single value, list, or numpy array.</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.array: Membership degree(s) in the range [0, 1]. Shape matches input.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; fs = FS(&quot;medium&quot;, [2, 3, 7, 8], [0, 10])</span>
<span class="sd">            &gt;&gt;&gt; print(fs.membership(5))    # 1.0 (in flat region)</span>
<span class="sd">            &gt;&gt;&gt; print(fs.membership(2.5)) # 0.5 (on rising slope)</span>
<span class="sd">            &gt;&gt;&gt; print(fs.membership([1, 5, 9])) # [0.0, 1.0, 0.0]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">trapezoidal_membership</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">membership_parameters</span><span class="p">)</span></div>



<div class="viewcode-block" id="FS.type">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.FS.type">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the fuzzy set type identifier.</span>

<span class="sd">        Returns:</span>
<span class="sd">            FUZZY_SETS: The type identifier (FUZZY_SETS.t1 for Type-1 fuzzy sets)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span></div>



<div class="viewcode-block" id="FS.__call__">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.FS.__call__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Calling the Fuzzy set returns its membership.</span>

<span class="sd">        :param x: input values in the fuzzy set referencial domain.</span>
<span class="sd">        :return: membership of the fuzzy set.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">membership</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>

    

<div class="viewcode-block" id="FS.__str__">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.FS.__str__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the name of the fuzzy set, its type and its parameters.</span>
<span class="sd">        </span>
<span class="sd">        :return: string.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">) - </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">membership_parameters</span><span class="si">}</span><span class="s1">&#39;</span></div>

    

<div class="viewcode-block" id="FS.shape">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.FS.shape">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the shape of the fuzzy set.</span>

<span class="sd">        :return: string.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;trapezoid&#39;</span></div>
</div>



<span class="k">class</span><span class="w"> </span><span class="nc">triangularFS</span><span class="p">(</span><span class="n">FS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Type-1 fuzzy set with a triangular membership function.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">membership_parameters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">domain</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a triangular fuzzy set.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">membership_parameters</span><span class="p">,</span> <span class="n">domain</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the shape identifier used in plotting/inspection.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;triangular&#39;</span>


<div class="viewcode-block" id="categoricalFS">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.categoricalFS">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">categoricalFS</span><span class="p">(</span><span class="n">FS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Type-1 fuzzy set for crisp categorical variables.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="categoricalFS.__init__">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.categoricalFS.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creates a categorical fuzzy set. It gives 1 to the category and 0 to the rest.</span>
<span class="sd">        Use it when the variable is categorical and the categories are known, so that rule inference systems</span>
<span class="sd">        can naturally support both crisp and fuzzy variables.</span>

<span class="sd">        :param name: string.</span>
<span class="sd">        :param categories: list of strings. Possible categories.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">=</span> <span class="n">category</span></div>



<div class="viewcode-block" id="categoricalFS.membership">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.categoricalFS.membership">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">membership</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the membership of a point or vector of elements.</span>

<span class="sd">        :param x: input values in the referencial domain.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">_is_torch_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">torch</span> <span class="o">=</span> <span class="n">_get_torch</span><span class="p">()</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span> <span class="k">if</span> <span class="n">elem</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="k">else</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="k">else</span> <span class="mf">0.0</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">elem</span><span class="p">:</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">elem</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">)</span>
            
        <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="categoricalFS.type">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.categoricalFS.type">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the corresponding fuzzy set type according to FUZZY_SETS enum.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span></div>

    

<div class="viewcode-block" id="categoricalFS.__str__">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.categoricalFS.__str__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the name of the fuzzy set, its type and its parameters.</span>
<span class="sd">        </span>
<span class="sd">        :return: string.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Categorical set: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">, type 1 output&#39;</span></div>

    

<div class="viewcode-block" id="categoricalFS.shape">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.categoricalFS.shape">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the shape of the fuzzy set.</span>

<span class="sd">        :return: string.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;categorical&#39;</span></div>
</div>



<span class="k">class</span><span class="w"> </span><span class="nc">IVFS</span><span class="p">(</span><span class="n">FS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Interval-Valued Fuzzy Set (Type-2 Fuzzy Set) class.</span>
<span class="sd">    </span>
<span class="sd">    This class implements Type-2 fuzzy sets using interval-valued membership functions.</span>
<span class="sd">    Each point in the domain has an interval [lower, upper] representing the uncertainty</span>
<span class="sd">    in the membership degree, providing a more flexible representation than Type-1 sets.</span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        name (str): Linguistic name of the fuzzy set</span>
<span class="sd">        domain (list[float]): Universe of discourse [min, max]</span>
<span class="sd">        secondMF_lower (list[float]): Parameters for the lower membership function</span>
<span class="sd">        secondMF_upper (list[float]): Parameters for the upper membership function  </span>
<span class="sd">        lower_height (float): Height of the lower membership function</span>
<span class="sd">        </span>
<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; ivfs = IVFS(&quot;medium&quot;, [2,3,7,8], [1,2,8,9], [0,10], 0.8)</span>
<span class="sd">        &gt;&gt;&gt; membership = ivfs.membership(5)  </span>
<span class="sd">        &gt;&gt;&gt; print(membership)  # Returns [lower_membership, upper_membership]</span>
<span class="sd">        </span>
<span class="sd">    Note:</span>
<span class="sd">        The upper membership function should be contained within the lower membership</span>
<span class="sd">        function to maintain mathematical consistency of Type-2 fuzzy sets.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">secondMF_lower</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">secondMF_upper</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> 
                <span class="n">domain</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">lower_height</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize an Interval-Valued Fuzzy Set.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): Linguistic name for the fuzzy set</span>
<span class="sd">            secondMF_lower (list[float]): Four parameters [a,b,c,d] for lower trapezoidal </span>
<span class="sd">                membership function (outer boundary)</span>
<span class="sd">            secondMF_upper (list[float]): Four parameters [a,b,c,d] for upper trapezoidal</span>
<span class="sd">                membership function (inner boundary)</span>
<span class="sd">            domain (list[float]): Two-element list [min, max] defining universe of discourse</span>
<span class="sd">            lower_height (float, optional): Maximum height of lower membership function.</span>
<span class="sd">                Defaults to 1.0.</span>
<span class="sd">                </span>
<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: If membership function parameters are inconsistent or invalid</span>
<span class="sd">            </span>
<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; ivfs = IVFS(&quot;high&quot;, [6,7,9,10], [6.5,7.5,8.5,9.5], [0,10], 0.9)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="n">domain</span>

        <span class="k">assert</span> <span class="n">secondMF_lower</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">secondMF_upper</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;First term membership incoherent&#39;</span>
        <span class="k">assert</span> <span class="n">secondMF_lower</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">secondMF_lower</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">secondMF_lower</span><span class="p">[</span>
            <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">secondMF_lower</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">secondMF_lower</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">secondMF_lower</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;Lower memberships incoherent. &#39;</span>
        <span class="k">assert</span> <span class="n">secondMF_upper</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">secondMF_upper</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">secondMF_upper</span><span class="p">[</span>
            <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">secondMF_upper</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">secondMF_upper</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">secondMF_upper</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;Upper memberships incoherent.&#39;</span>
        <span class="k">assert</span> <span class="n">secondMF_lower</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">secondMF_upper</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;Final term memberships incoherent.&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">secondMF_lower</span> <span class="o">=</span> <span class="n">secondMF_lower</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secondMF_upper</span> <span class="o">=</span> <span class="n">secondMF_upper</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lower_height</span> <span class="o">=</span> <span class="n">lower_height</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">membership</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the iv-membership of a point or a vector.</span>

<span class="sd">        :param x: input values in the fuzzy set referencial domain.</span>
<span class="sd">        :return: iv-membership of the fuzzy set.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">trapezoidal_membership</span><span class="p">(</span>
            <span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondMF_lower</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower_height</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">trapezoidal_membership</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondMF_upper</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">lower</span> <span class="o">&lt;=</span> <span class="n">upper</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">lower</span> <span class="o">&gt;</span> <span class="n">upper</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the corresponding fuzzy set type according to FUZZY_SETS enum: (t2)</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span>
    

    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the name of the fuzzy set, its type and its parameters.</span>
<span class="sd">        </span>
<span class="sd">        :return: string.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">()</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">) - </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">secondMF_lower</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">secondMF_upper</span><span class="si">}</span><span class="s1">&#39;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">categoricalIVFS</span><span class="p">(</span><span class="n">IVFS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class to define a iv fuzzy set with categorical membership.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">category</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creates a categorical iv fuzzy set. It gives 1 to the category and 0 to the rest.</span>
<span class="sd">        Use it when the variable is categorical and the categories are known, so that rule inference systems</span>
<span class="sd">        can naturally support both crisp and fuzzy variables.</span>

<span class="sd">        :param name: string.</span>
<span class="sd">        :param categories: list of strings. Possible categories.</span>
<span class="sd">        :param domain: list of two numbers. Limits of the domain if the fuzzy set.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">=</span> <span class="n">category</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">membership</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the membership of a point or vector of elements.</span>

<span class="sd">        :param x: input values in the referencial domain.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">res</span><span class="p">,</span> <span class="n">res</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">_is_torch_tensor</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="n">torch</span> <span class="o">=</span> <span class="n">_get_torch</span><span class="p">()</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">res</span><span class="p">,</span> <span class="n">res</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span> <span class="k">if</span> <span class="n">elem</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="k">else</span> <span class="mf">0.0</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">res</span><span class="p">,</span> <span class="n">res</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="k">else</span> <span class="mf">0.0</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">res</span><span class="p">,</span> <span class="n">res</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">elem</span><span class="p">:</span> <span class="mf">1.0</span> <span class="k">if</span> <span class="n">elem</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">res</span><span class="p">,</span> <span class="n">res</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">res</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the corresponding fuzzy set type according to FUZZY_SETS enum.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span>


    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the name of the fuzzy set, its type and its parameters.</span>
<span class="sd">        </span>
<span class="sd">        :return: string.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Categorical set: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">, type 2 output&#39;</span>
    

    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the shape of the fuzzy set.</span>

<span class="sd">        :return: string.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;categorical&#39;</span>


<span class="k">class</span><span class="w"> </span><span class="nc">GT2</span><span class="p">(</span><span class="n">FS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Class to define a gt2 fuzzy set.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">MAX_RES_SUPPORT</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># Number of decimals supported in the secondary</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">secondary_memberships</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">FS</span><span class="p">],</span> 
                <span class="n">domain</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">significant_decimals</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> 
                <span class="n">alpha_cuts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> 
                <span class="n">unit_resolution</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creates a GT2 fuzzy set.</span>

<span class="sd">        :param name: string.</span>
<span class="sd">        :param secondary_memberships: list of fuzzy sets. Secondary membership that maps original domain to [0, 1]</span>
<span class="sd">        :param secondMF_upper: four real numbers. Parameters of the upper trapezoid/gaussian function.</span>
<span class="sd">        :param domain: list of two numbers. Limits of the domain if the fuzzy set.</span>
<span class="sd">        :param alpha_cuts: list of real numbers. Alpha cuts of the fuzzy set.</span>
<span class="sd">        :param unit_resolution: real number. Resolution of the primary membership function.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="n">domain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">secondary_memberships</span> <span class="o">=</span> <span class="n">secondary_memberships</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span> <span class="o">=</span> <span class="n">alpha_cuts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">iv_secondary_memberships</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unit_resolution</span> <span class="o">=</span> <span class="n">unit_resolution</span>
        <span class="n">og_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">secondary_memberships</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">significant_decimals</span> <span class="o">=</span> <span class="n">significant_decimals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">domain_init</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
            <span class="nb">float</span><span class="p">(</span><span class="n">og_keys</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">significant_decimals</span><span class="p">)</span>

        <span class="n">formatted_keys</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;%.&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">significant_decimals</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span> <span class="o">%</span>
                          <span class="n">xz</span> <span class="k">for</span> <span class="n">xz</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">secondary_memberships</span><span class="o">.</span><span class="n">keys</span><span class="p">()))]</span>
        <span class="k">for</span> <span class="n">og_key</span><span class="p">,</span> <span class="n">formatted_key</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">og_keys</span><span class="p">,</span> <span class="n">formatted_keys</span><span class="p">):</span>
            <span class="n">secondary_memberships</span><span class="p">[</span><span class="n">formatted_key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_memberships</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span>
                <span class="n">og_key</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sample_unit_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span>
            <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_resolution</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_resolution</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">alpha_cut</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alpha_cuts</span><span class="p">):</span>
            <span class="n">level_memberships</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">array_level_memberships</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">secondary_memberships</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span> <span class="mi">2</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">jx</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">secondary_memberships</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">alpha_primary_memberships</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">membership</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">sample_unit_domain</span><span class="p">)</span>
                <span class="n">alpha_membership</span> <span class="o">=</span> <span class="n">alpha_primary_memberships</span> <span class="o">&gt;=</span> <span class="n">alpha_cut</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_unit_domain</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span>
                        <span class="n">alpha_membership</span><span class="p">)[</span><span class="mi">0</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sample_unit_domain</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span>
                        <span class="n">alpha_membership</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>  <span class="c1"># If no numbers are bigger than alpha, then it is because of rounding errors near 0. So, we fix this manually.</span>
                    <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="n">alpha_cut_interval</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">]</span>

                <span class="n">level_memberships</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha_cut_interval</span>
                <span class="n">array_level_memberships</span><span class="p">[</span><span class="n">jx</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">alpha_cut_interval</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">iv_secondary_memberships</span><span class="p">[</span><span class="n">alpha_cut</span><span class="p">]</span> <span class="o">=</span> <span class="n">array_level_memberships</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">membership</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the alpha cut memberships of a point.</span>

<span class="sd">        :param x: input values in the fuzzy set referencial domain.</span>
<span class="sd">        :return: np array samples x alpha_cuts x 2</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="c1"># locate the x in the secondary membership</span>
        <span class="n">formatted_x</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">x</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">significant_decimals</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain_init</span>

        <span class="c1"># Once the x is located we compute the function for each alpha cut</span>
        <span class="n">alpha_cut_memberships</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span><span class="p">):</span>
            <span class="n">ivfs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iv_secondary_memberships</span><span class="p">[</span><span class="n">alpha</span><span class="p">][</span><span class="n">formatted_x</span><span class="p">]))</span>
            <span class="n">alpha_cut_memberships</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">ivfs</span><span class="p">))</span>

        <span class="n">alpha_cut_memberships</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">alpha_cut_memberships</span><span class="p">)</span>

        <span class="c1"># So that the result is samples x alpha_cuts x 2</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">alpha_cut_memberships</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the fuzzy set type identifier for GT2 sets.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">gt2</span>
    

    <span class="k">def</span><span class="w"> </span><span class="nf">_alpha_reduction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the type reduction to reduce the alpha cuts to one value.</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :return: array with the memberships of the consequents for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">formatted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">formatted</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">formatted</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">alpha_cuts</span><span class="p">)</span>
    

    <span class="k">def</span><span class="w"> </span><span class="nf">alpha_reduction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the type reduction to reduce the alpha cuts to one value.</span>

<span class="sd">        :param x: array with the values of the inputs.</span>
<span class="sd">        :return: array with the memberships of the consequents for each sample.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_alpha_reduction</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        

<div class="viewcode-block" id="gaussianIVFS">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.gaussianIVFS">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">gaussianIVFS</span><span class="p">(</span><span class="n">IVFS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gaussian Interval-Valued (Type-2) Fuzzy Set Implementation.</span>
<span class="sd">    </span>
<span class="sd">    This class implements a Gaussian interval-valued fuzzy set with two Gaussian</span>
<span class="sd">    membership functions (upper and lower) representing the uncertainty boundaries.</span>
<span class="sd">    This allows for modeling higher-order uncertainty in fuzzy systems.</span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        secondMF_lower (list): Parameters [mean, std] for the lower membership function</span>
<span class="sd">        secondMF_upper (list): Parameters [mean, std] for the upper membership function</span>
<span class="sd">        name (str): Human-readable name for the fuzzy set</span>
<span class="sd">        universe_size (int): Size of the universe of discourse</span>
<span class="sd">        </span>
<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; lower_params = [5.0, 1.0]</span>
<span class="sd">        &gt;&gt;&gt; upper_params = [5.0, 1.5]</span>
<span class="sd">        &gt;&gt;&gt; iv_gauss = gaussianIVFS(lower_params, upper_params, &quot;Medium&quot;, 10)</span>
<span class="sd">        &gt;&gt;&gt; membership = iv_gauss.membership(np.array([4.0, 5.0, 6.0]))</span>
<span class="sd">        &gt;&gt;&gt; print(membership.shape)  # (3, 2) - lower and upper bounds</span>
<span class="sd">        </span>
<span class="sd">    Note:</span>
<span class="sd">        The interval-valued membership function provides both lower and upper</span>
<span class="sd">        bounds for each input, enabling Type-2 fuzzy reasoning.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="gaussianIVFS.membership">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.gaussianIVFS.membership">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">membership</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Gaussian interval-valued membership values for input points.</span>
<span class="sd">        </span>
<span class="sd">        Returns both lower and upper membership bounds for each input value,</span>
<span class="sd">        enabling Type-2 fuzzy set operations.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            input (np.array): Input values in the fuzzy set domain</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            np.array: Array of shape (n, 2) with [lower, upper] bounds for each input</span>
<span class="sd">            </span>
<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; iv_gauss = gaussianIVFS([0, 1], [0, 1.5], &quot;Zero&quot;, 5)</span>
<span class="sd">            &gt;&gt;&gt; values = iv_gauss.membership(np.array([0.0, 1.0]))</span>
<span class="sd">            &gt;&gt;&gt; print(values.shape)  # (2, 2) - 2 inputs, 2 bounds each</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">_gaussian2</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondMF_lower</span><span class="p">)</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">_gaussian2</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondMF_upper</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">]))</span><span class="o">.</span><span class="n">T</span></div>


<div class="viewcode-block" id="gaussianIVFS.type">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.gaussianIVFS.type">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the type of the fuzzy set.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            FUZZY_SETS: Always returns FUZZY_SETS.t2 for Type-2 fuzzy sets</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t2</span></div>


<div class="viewcode-block" id="gaussianIVFS.shape">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.gaussianIVFS.shape">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the shape of the fuzzy set.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: Always returns &#39;gaussian&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;gaussian&#39;</span></div>
</div>

    

<div class="viewcode-block" id="gaussianFS">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.gaussianFS">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">gaussianFS</span><span class="p">(</span><span class="n">FS</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Gaussian Type-1 Fuzzy Set Implementation.</span>
<span class="sd">    </span>
<span class="sd">    This class implements a Gaussian fuzzy set with bell-shaped membership function.</span>
<span class="sd">    Gaussian fuzzy sets are characterized by their mean and standard deviation,</span>
<span class="sd">    providing smooth membership transitions ideal for continuous variables.</span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        membership_parameters (list): [mean, standard_deviation] defining the Gaussian curve</span>
<span class="sd">        name (str): Human-readable name for the fuzzy set</span>
<span class="sd">        universe_size (int): Size of the universe of discourse</span>
<span class="sd">        </span>
<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; params = [5.0, 1.5]  # mean=5, std=1.5</span>
<span class="sd">        &gt;&gt;&gt; gauss_fs = gaussianFS(params, &quot;Medium&quot;, 10)</span>
<span class="sd">        &gt;&gt;&gt; membership = gauss_fs.membership(np.array([4.0, 5.0, 6.0]))</span>
<span class="sd">        &gt;&gt;&gt; print(membership)  # [0.606, 1.0, 0.606]</span>
<span class="sd">        </span>
<span class="sd">    Note:</span>
<span class="sd">        The membership function follows the formula:</span>
<span class="sd">        (x) = exp(-0.5 * ((x - mean) / std)^2)</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="gaussianFS.membership">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.gaussianFS.membership">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">membership</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the Gaussian membership values for input points.</span>
<span class="sd">        </span>
<span class="sd">        The membership function implements the Gaussian curve formula using</span>
<span class="sd">        the mean and standard deviation parameters.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            input (np.array): Input values in the fuzzy set domain</span>
<span class="sd">            </span>
<span class="sd">        Returns:</span>
<span class="sd">            np.array: Membership values in range [0, 1]</span>
<span class="sd">            </span>
<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; gauss_fs = gaussianFS([0, 1], &quot;Zero&quot;, 5)</span>
<span class="sd">            &gt;&gt;&gt; values = gauss_fs.membership(np.array([-1, 0, 1]))</span>
<span class="sd">            &gt;&gt;&gt; print(values)  # [0.606, 1.0, 0.606]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_gaussian2</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">membership_parameters</span><span class="p">)</span></div>


<div class="viewcode-block" id="gaussianFS.type">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.gaussianFS.type">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the type of the fuzzy set.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            FUZZY_SETS: Always returns FUZZY_SETS.t1 for Type-1 fuzzy sets</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span></div>


<div class="viewcode-block" id="gaussianFS.shape">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.gaussianFS.shape">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the shape of the fuzzy set.</span>
<span class="sd">        </span>
<span class="sd">        Returns:</span>
<span class="sd">            str: Always returns &#39;gaussian&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;gaussian&#39;</span></div>
</div>



<div class="viewcode-block" id="fuzzyVariable">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">fuzzyVariable</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fuzzy Variable Container and Management Class.</span>
<span class="sd">    </span>
<span class="sd">    This class represents a fuzzy variable composed of multiple fuzzy sets</span>
<span class="sd">    (linguistic variables). It provides methods to compute memberships across</span>
<span class="sd">    all fuzzy sets and manage the linguistic terms of the variable.</span>
<span class="sd">    </span>
<span class="sd">    Attributes:</span>
<span class="sd">        linguistic_variables (list): List of fuzzy sets that define the variable</span>
<span class="sd">        name (str): Name of the fuzzy variable</span>
<span class="sd">        units (str): Units of measurement (optional, for display purposes)</span>
<span class="sd">        fs_type (FUZZY_SETS): Type of fuzzy sets (t1 or t2)</span>
<span class="sd">        </span>
<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; # Create fuzzy sets for temperature</span>
<span class="sd">        &gt;&gt;&gt; low_temp = gaussianFS([15, 5], &quot;Low&quot;, 100)</span>
<span class="sd">        &gt;&gt;&gt; medium_temp = gaussianFS([25, 5], &quot;Medium&quot;, 100)</span>
<span class="sd">        &gt;&gt;&gt; high_temp = gaussianFS([35, 5], &quot;High&quot;, 100)</span>
<span class="sd">        &gt;&gt;&gt; </span>
<span class="sd">        &gt;&gt;&gt; # Create fuzzy variable</span>
<span class="sd">        &gt;&gt;&gt; temp_var = fuzzyVariable(&quot;Temperature&quot;, [low_temp, medium_temp, high_temp], &quot;C&quot;)</span>
<span class="sd">        &gt;&gt;&gt; memberships = temp_var.membership([20, 25, 30])</span>
<span class="sd">        &gt;&gt;&gt; print(memberships.shape)  # (3, 3) - 3 inputs, 3 fuzzy sets</span>
<span class="sd">        </span>
<span class="sd">    Note:</span>
<span class="sd">        All fuzzy sets in the variable must be of the same type (t1 or t2).</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="fuzzyVariable.__init__">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">fuzzy_sets</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">FS</span><span class="p">],</span> <span class="n">units</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a fuzzy variable with the specified fuzzy sets.</span>
<span class="sd">        </span>
<span class="sd">        Args:</span>
<span class="sd">            name (str): Name of the fuzzy variable</span>
<span class="sd">            fuzzy_sets (list[FS]): List of fuzzy sets that comprise the linguistic variables</span>
<span class="sd">            units (str, optional): Units of the fuzzy variable for display purposes</span>
<span class="sd">            </span>
<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If fuzzy_sets is empty or contains mixed types</span>
<span class="sd">            </span>
<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; fs1 = gaussianFS([0, 1], &quot;Low&quot;, 10)</span>
<span class="sd">            &gt;&gt;&gt; fs2 = gaussianFS([5, 1], &quot;High&quot;, 10)</span>
<span class="sd">            &gt;&gt;&gt; var = fuzzyVariable(&quot;Speed&quot;, [fs1, fs2], &quot;m/s&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>

        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">fs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fuzzy_sets</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fs_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">()</span></div>



<div class="viewcode-block" id="fuzzyVariable.append">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.append">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fs</span><span class="p">:</span> <span class="n">FS</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Appends a fuzzy set to the fuzzy variable.</span>

<span class="sd">        :param fs: FS. Fuzzy set to append.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fs</span><span class="p">)</span></div>



<div class="viewcode-block" id="fuzzyVariable.linguistic_variable_names">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.linguistic_variable_names">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">linguistic_variable_names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the name of the linguistic variables.</span>

<span class="sd">        :return: list of strings.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">fs</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">fs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">]</span></div>



<div class="viewcode-block" id="fuzzyVariable.get_linguistic_variables">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.get_linguistic_variables">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_linguistic_variables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">FS</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the name of the linguistic variables.</span>

<span class="sd">        :return: list of strings.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span></div>



<div class="viewcode-block" id="fuzzyVariable.compute_memberships">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.compute_memberships">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute_memberships</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the membership to each of the FS in the fuzzy variables.</span>

<span class="sd">        :param x: numeric value or array. Computes the membership to each of the FS in the fuzzy variables.</span>
<span class="sd">        :return: list of floats. Membership to each of the FS in the fuzzy variables.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">domain</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">domain</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">for</span> <span class="n">fuzzy_set</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fuzzy_set</span><span class="o">.</span><span class="n">membership</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>



<div class="viewcode-block" id="fuzzyVariable.domain">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.domain">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">domain</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the domain of the fuzzy variable.</span>

<span class="sd">        :return: list of floats.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">domain</span></div>



<div class="viewcode-block" id="fuzzyVariable.fuzzy_type">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.fuzzy_type">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">fuzzy_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FUZZY_SETS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the fuzzy type of the domain</span>

<span class="sd">        :return: the type of the fuzzy set present in the fuzzy variable.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fs_type</span></div>

    

    <span class="k">def</span><span class="w"> </span><span class="nf">_permutation_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu_A</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">mu_B</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">p_value_need</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Validates the fuzzy variable using permutation test to check if the fuzzy sets are statistically different.</span>

<span class="sd">        :param mu_A: np.array. Memberships of the first fuzzy set.</span>
<span class="sd">        :param mu_B: np.array. Memberships of the second fuzzy set.</span>
<span class="sd">        :return: bool. True if the fuzzy sets are statistically different, False otherwise.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">permutation_test</span>

        <span class="c1"># Perform permutation test</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">permutation_test</span><span class="p">(</span>
            <span class="p">(</span><span class="n">mu_A</span><span class="p">,</span> <span class="n">mu_B</span><span class="p">),</span> 
            <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">),</span> 
            <span class="n">n_resamples</span><span class="o">=</span><span class="mi">1000</span>
        <span class="p">)</span>
        <span class="n">statistic</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">null_distribution</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">statistic</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">null_distribution</span>

        <span class="k">return</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="n">p_value_need</span>
    

<div class="viewcode-block" id="fuzzyVariable.validate">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.validate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Validates the fuzzy variable. Checks that all the fuzzy sets have the same type and domain.</span>

<span class="sd">        :param X: np.array. Input data to validate the fuzzy variable.</span>
<span class="sd">        :return: bool. True if the fuzzy variable is valid, False otherwise.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        
        <span class="c1"># Get the fuzzy sets memberships</span>
        <span class="n">memberships</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_memberships</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">memberships</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">memberships</span><span class="p">)</span>

        <span class="n">cond1</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Property 1: Only one of the fuzzy sets memberships can be 1 at the same time</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">memberships</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">cond1</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Property 1 violated: More than one fuzzy set has a membership of 1 at the same time.&#39;</span><span class="p">)</span>

        <span class="c1"># Property 2: All fuzzy sets are fuzzy numbers is fullfilled if they are trapezoidal or gaussian</span>
        <span class="n">cond2</span> <span class="o">=</span> <span class="nb">all</span><span class="p">([</span><span class="n">fs</span><span class="o">.</span><span class="n">shape</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;trapezoid&#39;</span><span class="p">,</span> <span class="s1">&#39;triangular&#39;</span><span class="p">,</span> <span class="s1">&#39;gaussian&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">fs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Property 2 violated: Not all fuzzy sets are fuzzy numbers (trapezoidal or gaussian).&#39;</span><span class="p">)</span>

        <span class="c1"># Property 3: At least one fuzzy set must non zero in every point of the domain</span>
        <span class="n">cond3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">memberships</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cond3</span> <span class="ow">and</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Property 3 violated: At least one fuzzy set must be non-zero in every point of the domain.&#39;</span><span class="p">)</span>

        <span class="c1"># Property 4: Given any two points of the domain, if a &lt; b, the membership f_n+1(b)&gt;f_n+1(a) can only hold if f_n(a)&gt;f_n(b). So, a fuzzy set can only grow if the previous fuzzy set is decreasing.</span>
        <span class="n">cond4</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">memberships</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&lt;</span> <span class="n">memberships</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:])</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">memberships</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&gt;</span> <span class="n">memberships</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]):</span>
                <span class="n">valid</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">break</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cond4</span> <span class="ow">and</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Property 4 violated: Fuzzy sets must be non-decreasing in the domain. If a fuzzy set grows, the previous fuzzy set must be decreasing.&#39;</span><span class="p">)</span>

        
        <span class="c1"># Property 5: The smallest fuzzy set must be the first one and the biggest fuzzy set must be the last one. The smallest should start at the left of the domain and the biggest should end at the right of the domain.</span>
        <span class="n">cond5</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_memberships</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">domain</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.99</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compute_memberships</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">domain</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.99</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cond5</span> <span class="ow">and</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Property 5 violated: The smallest fuzzy set must be the first one and the biggest fuzzy set must be the last one. The smallest should start at the left of the domain and the biggest should end at the right of the domain.&#39;</span><span class="p">)</span>

        <span class="c1"># Property 6: The population of the fuzzy sets-induced memberships must be statistically different from each other</span>
        <span class="n">cond6</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="c1"># Wilcoxon signed-rank test is a paired difference test</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_permutation_validation</span><span class="p">(</span><span class="n">memberships</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="n">memberships</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:],</span> <span class="n">p_value_need</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
                    <span class="n">cond6</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">break</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cond6</span> <span class="ow">and</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Property 6 violated: The fuzzy sets must be statistically different from each other. Used permutation test to check this. (&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>

        <span class="n">valid</span> <span class="o">=</span> <span class="n">cond1</span> <span class="ow">and</span> <span class="n">cond2</span> <span class="ow">and</span> <span class="n">cond3</span> <span class="ow">and</span> <span class="n">cond4</span> <span class="ow">and</span> <span class="n">cond5</span> <span class="ow">and</span> <span class="n">cond6</span>

        <span class="k">if</span> <span class="n">verbose</span> <span class="ow">and</span> <span class="n">valid</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Fuzzy variable &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; is valid.&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">valid</span></div>



<div class="viewcode-block" id="fuzzyVariable.__str__">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.__str__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the name of the fuzzy variable, its type and its parameters.</span>
<span class="sd">        </span>
<span class="sd">        :return: string.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">fs_type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">) - </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variable_names</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span></div>



<div class="viewcode-block" id="fuzzyVariable.__getitem__">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.__getitem__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FS</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the corresponding fs.</span>

<span class="sd">        :param item: int. Index of the FS.</span>
<span class="sd">        :return: FS. The corresponding FS.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">[</span><span class="n">item</span><span class="p">]</span></div>



<div class="viewcode-block" id="fuzzyVariable.__setitem__">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.__setitem__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">elem</span><span class="p">:</span> <span class="n">FS</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Sets the corresponding fs.</span>

<span class="sd">        :param item: int. Index of the FS.</span>
<span class="sd">        :param elem: FS. The FS to set.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span></div>

    

<div class="viewcode-block" id="fuzzyVariable.__iter__">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.__iter__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">FS</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the corresponding fs.</span>

<span class="sd">        :param item: int. Index of the FS.</span>
<span class="sd">        :return: FS. The corresponding FS.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">fs</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">fs</span></div>



<div class="viewcode-block" id="fuzzyVariable.__len__">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.__len__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns the number of linguistic variables.</span>

<span class="sd">        :return: int. Number of linguistic variables.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">linguistic_variables</span><span class="p">)</span></div>

    

<div class="viewcode-block" id="fuzzyVariable.__call__">
<a class="viewcode-back" href="../../api/fuzzy_sets.html#ex_fuzzy.fuzzy_sets.fuzzyVariable.__call__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Computes the membership to each of the FS in the fuzzy variables.</span>

<span class="sd">        :param x: numeric value or array.</span>
<span class="sd">        :return: list of floats. Membership to each of the FS in the fuzzy variables.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_memberships</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>
</div>



</pre></div>

                </article>
              
              
              
              
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
       Copyright 2023-2026, Javier Fumanal Idocin.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>