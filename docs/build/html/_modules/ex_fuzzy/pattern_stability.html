
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ex_fuzzy.pattern_stability &#8212; Ex-Fuzzy 1.0.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=edfbbfd1" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=30646c52"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_modules/ex_fuzzy/pattern_stability';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs..."
         aria-label="Search the docs..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo-light.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../../_static/logo-dark.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">Ex-Fuzzy</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API Reference
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../api/fuzzy_sets.html">
    Fuzzy Sets
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../api/classifiers.html">
    Classifiers Module
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../api/evolutionary_fit.html">
    Evolutionary Fit Module
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../api/eval_tools.html">
    Evaluation Tools Module
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../contributing.html">
    Contributing
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../changelog.html">
    Changelog
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../roadmap.html">
    Roadmap
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../usage.html">
    Getting Started
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../step1.html">
    Creating fuzzy sets and fuzzy variables
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../step2.html">
    Using Fuzzy Rules
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../step3.html">
    Optimizing a Fuzzy rule base for a classification problem
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../step4.html">
    Visualize rules and results
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../precom.html">
    Computing fuzzy partitions
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../optimize.html">
    Genetic algorithm details
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../gt2.html">
    General Type 2
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../tmpfs.html">
    Temporal Fuzzy Sets
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../extending.html">
    Extending Ex-Fuzzy
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../persistence.html">
    Persistence
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../classifiers.html">
    Advanced classifiers
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../../pattern_stats.html">
    Bootstrapping and rule robustness
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/your-username/ex-fuzzy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/ex-fuzzy/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting-started.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user-guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../examples/index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/fuzzy_sets.html">
    Fuzzy Sets
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/classifiers.html">
    Classifiers Module
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/evolutionary_fit.html">
    Evolutionary Fit Module
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../api/eval_tools.html">
    Evaluation Tools Module
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributing.html">
    Contributing
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../changelog.html">
    Changelog
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../roadmap.html">
    Roadmap
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../usage.html">
    Getting Started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../step1.html">
    Creating fuzzy sets and fuzzy variables
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../step2.html">
    Using Fuzzy Rules
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../step3.html">
    Optimizing a Fuzzy rule base for a classification problem
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../step4.html">
    Visualize rules and results
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../precom.html">
    Computing fuzzy partitions
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../optimize.html">
    Genetic algorithm details
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../gt2.html">
    General Type 2
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../tmpfs.html">
    Temporal Fuzzy Sets
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../extending.html">
    Extending Ex-Fuzzy
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../persistence.html">
    Persistence
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../classifiers.html">
    Advanced classifiers
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../pattern_stats.html">
    Bootstrapping and rule robustness
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/your-username/ex-fuzzy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/ex-fuzzy/" title="PyPI" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fas fa-box fa-lg" aria-hidden="true"></i>
            <span class="sr-only">PyPI</span></a>
        </li>
</ul></div>
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Module code</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">ex_fuzzy.pat...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <h1>Source code for ex_fuzzy.pattern_stability</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Pattern Stability Analysis Module for Ex-Fuzzy Library</span>

<span class="sd">This module provides comprehensive analysis tools for assessing the stability and consistency</span>
<span class="sd">of patterns generated by fuzzy classifiers across multiple runs. It evaluates the reliability</span>
<span class="sd">of rule discovery and the robustness of fuzzy model generation through statistical analysis.</span>

<span class="sd">Main Components:</span>
<span class="sd">    - Pattern frequency analysis: Track occurrence rates of specific rule patterns</span>
<span class="sd">    - Variable usage analysis: Monitor how frequently each variable appears in rules</span>
<span class="sd">    - Stability metrics: Quantitative measures of pattern consistency</span>
<span class="sd">    - Multi-run experiments: Automated execution of multiple classifier runs</span>
<span class="sd">    - Statistical reporting: Comprehensive analysis of pattern stability</span>

<span class="sd">Key Features:</span>
<span class="sd">    - Automated multi-run experiments with configurable parameters</span>
<span class="sd">    - Pattern uniqueness detection and frequency counting</span>
<span class="sd">    - Variable importance analysis across multiple runs</span>
<span class="sd">    - Statistical significance testing for pattern stability</span>
<span class="sd">    - Visualization of pattern occurrence distributions</span>
<span class="sd">    - Integration with multiprocessing for efficient computation</span>
<span class="sd">    - Support for both Type-1 and Type-2 fuzzy systems</span>

<span class="sd">The module is essential for validating the reliability of fuzzy rule-based classifiers</span>
<span class="sd">and ensuring that discovered patterns are consistent and meaningful rather than artifacts</span>
<span class="sd">of random initialization or data sampling.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">multiprocessing.pool</span><span class="w"> </span><span class="kn">import</span> <span class="n">ThreadPool</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pymoo.core.problem</span><span class="w"> </span><span class="kn">import</span> <span class="n">StarmapParallelization</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.model_selection</span><span class="w"> </span><span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numbers</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">colormaps</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>

<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">fuzzy_sets</span> <span class="k">as</span> <span class="n">fs</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">rules</span> <span class="k">as</span> <span class="n">rl</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">evolutionary_fit</span> <span class="k">as</span> <span class="n">evf</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">vis_rules</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">eval_rules</span> <span class="k">as</span> <span class="n">evr</span>
    
<span class="k">except</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">fuzzy_sets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">fs</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">rules</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rl</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">evolutionary_fit</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">evf</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">vis_rules</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">eval_rules</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">evr</span>


<div class="viewcode-block" id="add_dicts">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.add_dicts">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">add_dicts</span><span class="p">(</span><span class="n">dict1</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">dict2</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="c1"># We will add the values of dict2 to dict1</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict2</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dict1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dict2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">dict1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">dict1</span></div>


<div class="viewcode-block" id="concatenate_dicts">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.concatenate_dicts">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">concatenate_dicts</span><span class="p">(</span><span class="n">dict1</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">dict2</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="c1"># We will concatenate the values of dict2 to dict1</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict2</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">dict1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">dict1</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">dict1</span></div>



<div class="viewcode-block" id="str_rule_as_list">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.str_rule_as_list">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">str_rule_as_list</span><span class="p">(</span><span class="n">rule</span><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
    <span class="c1"># We will transform the string form of a rule into a list of integers</span>
    <span class="n">rule</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">rule</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">rule</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">rule</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">rule</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    
    <span class="n">rule</span> <span class="o">=</span> <span class="n">rule</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">rr</span><span class="p">)</span> <span class="k">for</span> <span class="n">rr</span> <span class="ow">in</span> <span class="n">rule</span><span class="p">]</span></div>



<div class="viewcode-block" id="pattern_stabilizer">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">pattern_stabilizer</span><span class="p">():</span>

<div class="viewcode-block" id="pattern_stabilizer.__init__">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">nRules</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">nAnts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">fuzzy_type</span><span class="p">:</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">FUZZY_SETS</span><span class="o">.</span><span class="n">t1</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">class_names</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">n_linguistic_variables</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linguistic_variables</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">fs</span><span class="o">.</span><span class="n">fuzzyVariable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">domain</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_class</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">runner</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ds_mode</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">allow_unkown</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">fuzzy_modifiers</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stratify_by</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Inits the optimizer with the corresponding parameters.</span>

<span class="sd">        :param nRules: number of rules to optimize.</span>
<span class="sd">        :param nAnts: max number of antecedents to use.</span>
<span class="sd">        :param fuzzy type: FUZZY_SET enum type in fuzzy_sets module. The kind of fuzzy set used.</span>
<span class="sd">        :param tolerance: tolerance for the dominance score of the rules.</span>
<span class="sd">        :param n_linguist_variables: number of linguistic variables per antecedent.</span>
<span class="sd">        :param verbose: if True, prints the progress of the optimization.</span>
<span class="sd">        :param linguistic_variables: list of fuzzyVariables type. If None (default) the optimization process will init+optimize them.</span>
<span class="sd">        :param domain: list of the limits for each variable. If None (default) the classifier will compute them empirically.</span>
<span class="sd">        :param n_class: names of the classes in the problem. If None (default) the classifier will compute it empirically.</span>
<span class="sd">        :param precomputed_rules: MasterRuleBase object. If not None, the classifier will use the rules in the object and ignore the conflicting parameters.</span>
<span class="sd">        :param runner: number of threads to use. If None (default) the classifier will use 1 thread.</span>
<span class="sd">        :param stratify_by: string naming additional column to stratify test/train split if desired (e.g. split by participant rather than trial).</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nRules</span> <span class="o">=</span> <span class="n">nRules</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nAnts</span> <span class="o">=</span> <span class="n">nAnts</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nclasses_</span> <span class="o">=</span> <span class="n">n_class</span>

        <span class="k">if</span> <span class="n">class_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">classes_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">class_names</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">classes_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">class_names</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">classes_names</span> <span class="o">=</span> <span class="n">class_names</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">custom_loss</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ds_mode</span> <span class="o">=</span> <span class="n">ds_mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_unknown</span> <span class="o">=</span> <span class="n">allow_unkown</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_modifiers</span> <span class="o">=</span> <span class="n">fuzzy_modifiers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runner</span> <span class="o">=</span> <span class="n">runner</span>
        
        <span class="k">if</span> <span class="n">linguistic_variables</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># If the linguistic variables are precomputed then we act accordingly</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lvs</span> <span class="o">=</span> <span class="n">linguistic_variables</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_linguist_variables</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">lv</span><span class="o">.</span><span class="n">linguistic_variable_names</span><span class="p">())</span> <span class="k">for</span> <span class="n">lv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">lvs</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lvs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># If not, then we need the parameters sumistered by the user.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lvs</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span> <span class="o">=</span> <span class="n">fuzzy_type</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_linguist_variables</span> <span class="o">=</span> <span class="n">n_linguistic_variables</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">domain</span> <span class="o">=</span> <span class="n">domain</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beta_</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stratify_by</span> <span class="o">=</span> <span class="n">stratify_by</span></div>



<div class="viewcode-block" id="pattern_stabilizer.generate_solutions">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer.generate_solutions">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">generate_solutions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">n_gen</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pop_size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">stratify_by</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">):</span>
        <span class="c1"># We will generate n solutions and return the rule bases and the accuracies</span>
        <span class="c1"># Pre-defined stratification by additional column (e.g. participant vs. trial) if desired</span>
        <span class="n">rule_bases</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">accs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">use_names</span> <span class="o">=</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">)</span>
        <span class="n">strat_column</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">strat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stratify_by</span>

        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">fl_classifier</span> <span class="o">=</span> <span class="n">evf</span><span class="o">.</span><span class="n">BaseFuzzyRulesClassifier</span><span class="p">(</span><span class="n">nRules</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nRules</span><span class="p">,</span> <span class="n">linguistic_variables</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lvs</span><span class="p">,</span> <span class="n">nAnts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nAnts</span><span class="p">,</span> <span class="n">n_linguistic_variables</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_linguist_variables</span><span class="p">,</span> <span class="n">fuzzy_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_type</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">runner</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">runner</span><span class="p">,</span> <span class="n">ds_mode</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ds_mode</span><span class="p">,</span> <span class="n">fuzzy_modifiers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fuzzy_modifiers</span><span class="p">,</span> <span class="n">allow_unknown</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_unknown</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">strat</span><span class="p">:</span>
                <span class="n">strat_column</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stratify_by</span>
                <span class="c1"># Use strat_column to split the data then drop the column and perform test/train split</span>
                <span class="nb">id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">strat_column</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span> <span class="c1">#get unique ids in strat_column</span>
                <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">ix</span><span class="p">)</span> <span class="c1"># set different seeds to split data differently per iteration</span>
                <span class="n">test_ix</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="nb">id</span><span class="p">)),</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span><span class="o">*</span><span class="n">test_size</span><span class="p">))</span> <span class="c1">#randomly select indices for testing using test_size value</span>
                <span class="n">test_id</span> <span class="o">=</span> <span class="p">[</span><span class="nb">id</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">test_ix</span><span class="p">]</span> <span class="c1">#get labels for test ix</span>

                <span class="c1"># Get train/test X and y data</span>
                <span class="n">X_train</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="o">~</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">strat_column</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">test_id</span><span class="p">)]</span>
                <span class="n">X_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">strat_column</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">test_id</span><span class="p">)]</span>
                <span class="n">y_train</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X_train</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>
                <span class="n">y_test</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">X_test</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()]</span>

                <span class="c1"># Drop ID column for training</span>
                <span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">strat_column</span><span class="p">])</span>
                <span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">strat_column</span><span class="p">])</span>

                <span class="n">fl_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="n">n_gen</span><span class="o">=</span><span class="n">n_gen</span><span class="p">,</span> <span class="n">pop_size</span><span class="o">=</span><span class="n">pop_size</span><span class="p">,</span> <span class="n">checkpoints</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            
            <span class="k">else</span><span class="p">:</span>
                <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">ix</span><span class="p">)</span>
                <span class="n">fl_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="n">n_gen</span><span class="o">=</span><span class="n">n_gen</span><span class="p">,</span> <span class="n">pop_size</span><span class="o">=</span><span class="n">pop_size</span><span class="p">,</span> <span class="n">checkpoints</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


            <span class="n">rule_bases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fl_classifier</span><span class="o">.</span><span class="n">rule_base</span><span class="p">)</span>
            <span class="n">accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">fl_classifier</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">out_class_names</span><span class="o">=</span><span class="n">use_names</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_test</span><span class="p">)))</span>
            <span class="n">accs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">rule_bases</span><span class="p">,</span> <span class="n">accs</span></div>

    
<div class="viewcode-block" id="pattern_stabilizer.count_unique_patterns">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer.count_unique_patterns">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">count_unique_patterns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rule_base</span><span class="p">:</span> <span class="n">rl</span><span class="o">.</span><span class="n">RuleBase</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        We will count the number of unique patterns in the rule base. It will also count the number of times each variable is used in the rule base and the record the dominance score of each pattern.</span>

<span class="sd">        :param rule_base: RuleBase object. The rule base to analyze.</span>
<span class="sd">        :return unique_patterns: dict. The dictionary with the unique patterns and the number of times they appear.</span>
<span class="sd">        :return patterns_ds: dict. The dictionary with the dominance score of each pattern.</span>
<span class="sd">        :return var_used: dict. The dictionary with the number of times each variable is used in the rule base.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">unique_patterns</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">patterns_ds</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">var_used</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rule_base</span><span class="o">.</span><span class="n">get_rulebase_matrix</span><span class="p">()):</span>
            <span class="n">pattern</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="p">)</span>
            <span class="n">patterns_ds</span><span class="p">[</span><span class="n">pattern</span><span class="p">]</span> <span class="o">=</span> <span class="n">rule_base</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">score</span>
            <span class="k">if</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">unique_patterns</span><span class="p">:</span>
                <span class="n">unique_patterns</span><span class="p">[</span><span class="n">pattern</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">unique_patterns</span><span class="p">[</span><span class="n">pattern</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">for</span> <span class="n">jx</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rule</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">var_used</span><span class="p">[</span><span class="n">jx</span><span class="p">][</span><span class="n">var</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">var_used</span><span class="p">[</span><span class="n">jx</span><span class="p">][</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">var_used</span><span class="p">[</span><span class="n">jx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="n">var_used</span><span class="p">[</span><span class="n">jx</span><span class="p">][</span><span class="n">var</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        

        
        <span class="k">return</span> <span class="n">unique_patterns</span><span class="p">,</span> <span class="n">patterns_ds</span><span class="p">,</span> <span class="n">var_used</span></div>

    
<div class="viewcode-block" id="pattern_stabilizer.count_unique_patterns_all_classes">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer.count_unique_patterns_all_classes">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">count_unique_patterns_all_classes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mrule_base</span><span class="p">:</span> <span class="n">rl</span><span class="o">.</span><span class="n">MasterRuleBase</span><span class="p">,</span> <span class="n">class_patterns</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">patterns_dss</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">class_vars</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Counts the number of unique patterns for all classes. It also counts the number of times each variable is used in the rule base and the dominance score of each pattern.</span>

<span class="sd">        :param mrule_base: MasterRuleBase object. The rule base to analyze.</span>
<span class="sd">        :param class_patterns: dict[list]. The dictionary with the unique patterns for each class. If None, it will be initialized.</span>
<span class="sd">        :param patterns_dss: dict[list]. The dictionary with the dominance score of each pattern for each class. If None, it will be initialized.</span>
<span class="sd">        :param class_vars: dict[list]. The dictionary with the number of times each variable is used in the rule base for each class. If None, it will be initialized.</span>
<span class="sd">        :return class_patterns: dict[list]. The dictionary with the unique patterns for each class.</span>
<span class="sd">        :return patterns_dss: dict[list]. The dictionary with the dominance score of each pattern for each class.</span>
<span class="sd">        :return class_vars: dict[list]. The dictionary with the number of times each variable is used in the rule base for each class.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">class_patterns</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">class_patterns</span> <span class="o">=</span> <span class="p">{</span><span class="n">ix</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mrule_base</span><span class="p">))}</span>
            <span class="n">class_vars</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mrule_base</span><span class="p">)):</span>
                <span class="n">class_vars</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">jx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mrule_base</span><span class="o">.</span><span class="n">n_linguistic_variables</span><span class="p">())):</span>
                    <span class="n">class_vars</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="n">jx</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">zx</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">zx</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">mrule_base</span><span class="o">.</span><span class="n">n_linguistic_variables</span><span class="p">()[</span><span class="n">key</span><span class="p">])}</span>

            <span class="n">patterns_dss</span> <span class="o">=</span> <span class="p">{</span><span class="n">ix</span><span class="p">:</span> <span class="p">{}</span> <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mrule_base</span><span class="p">))}</span>

        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">rule_base</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mrule_base</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rule_base</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">unique_patterns</span><span class="p">,</span> <span class="n">patterns_ds</span><span class="p">,</span> <span class="n">var_used</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_unique_patterns</span><span class="p">(</span><span class="n">rule_base</span><span class="p">)</span>
                <span class="n">class_patterns</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_dicts</span><span class="p">(</span><span class="n">class_patterns</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">unique_patterns</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">class_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="n">class_vars</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">add_dicts</span><span class="p">(</span><span class="n">class_vars</span><span class="p">[</span><span class="n">ix</span><span class="p">][</span><span class="n">key</span><span class="p">],</span> <span class="n">var_used</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

                <span class="n">patterns_dss</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">concatenate_dicts</span><span class="p">(</span><span class="n">patterns_dss</span><span class="p">[</span><span class="n">ix</span><span class="p">],</span> <span class="n">patterns_ds</span><span class="p">)</span>
            

        <span class="k">return</span> <span class="n">class_patterns</span><span class="p">,</span> <span class="n">patterns_dss</span><span class="p">,</span> <span class="n">class_vars</span></div>

    

<div class="viewcode-block" id="pattern_stabilizer.get_patterns_scores">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer.get_patterns_scores">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_patterns_scores</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">n_gen</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">pop_size</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">test_size</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">0.33</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Gets the patterns scores for the generated solutions.</span>

<span class="sd">        :param n: int. The number of solutions to generate.</span>
<span class="sd">        :param test_size: int defines train/test split</span>
<span class="sd">        :return class_patterns: dict[list]. The dictionary with the unique patterns for each class.</span>
<span class="sd">        :return patterns_dss: dict[list]. The dictionary with the dominance score of each pattern for each class.</span>
<span class="sd">        :return class_vars: dict[list]. The dictionary with the number of times each variable is used in the rule base for each class.</span>
<span class="sd">        :return accuracies: list. The list with the accuracies of the generated solutions.</span>
<span class="sd">        :return rule_bases: list. The list with the generated rule bases.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">rule_bases</span><span class="p">,</span> <span class="n">accuracies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_solutions</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n_gen</span><span class="o">=</span><span class="n">n_gen</span><span class="p">,</span> <span class="n">pop_size</span><span class="o">=</span><span class="n">pop_size</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
        <span class="n">faults</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">mrule_base</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rule_bases</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mrule_base</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ix</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">class_patterns</span><span class="p">,</span> <span class="n">patterns_dss</span><span class="p">,</span> <span class="n">class_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_unique_patterns_all_classes</span><span class="p">(</span><span class="n">mrule_base</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">class_patterns</span><span class="p">,</span> <span class="n">patterns_dss</span><span class="p">,</span> <span class="n">class_vars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count_unique_patterns_all_classes</span><span class="p">(</span><span class="n">mrule_base</span><span class="p">,</span> <span class="n">class_patterns</span><span class="p">,</span> <span class="n">patterns_dss</span><span class="p">,</span> <span class="n">class_vars</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">faults</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No rules were generated for solution </span><span class="si">{</span><span class="n">ix</span><span class="si">}</span><span class="s1">. Percentage of faulty solutions: </span><span class="si">{</span><span class="n">faults</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
            
        <span class="c1"># Sort the patterns by the number of appearances</span>
        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_patterns</span><span class="p">)):</span>
            <span class="n">class_patterns</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">class_patterns</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="n">patterns_dss</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">patterns_dss</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">class_patterns</span><span class="p">,</span> <span class="n">patterns_dss</span><span class="p">,</span> <span class="n">class_vars</span><span class="p">,</span> <span class="n">accuracies</span><span class="p">,</span> <span class="n">rule_bases</span></div>

    

<div class="viewcode-block" id="pattern_stabilizer.var_reports">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer.var_reports">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">var_reports</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_vars</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">antecedents</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates variable reports.</span>
<span class="sd">        </span>
<span class="sd">        :param class_vars: dict. The dictionary with the number of times each variable is used in the rule base for each class.</span>
<span class="sd">        :param antecedents: list. The list of antecedents.</span>
<span class="sd">        :param cutoff: int. The number of variables to show in the report.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">jx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_vars</span><span class="p">)):</span>
            <span class="n">initiated</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">sorted_class_ix</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">class_vars</span><span class="p">[</span><span class="n">jx</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sorted_class_ix</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">sorted_class_ix</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ix</span> <span class="o">&gt;</span> <span class="n">cutoff</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">initiated</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Variable </span><span class="si">{</span><span class="n">antecedents</span><span class="p">[</span><span class="n">jx</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">initiated</span> <span class="o">=</span> <span class="kc">True</span>

                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">antecedents</span><span class="p">[</span><span class="n">jx</span><span class="p">][</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> appears %.2f times per experiment.&#39;</span> <span class="o">%</span> <span class="nb">float</span><span class="p">(</span><span class="n">class_vars</span><span class="p">[</span><span class="n">jx</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">initiated</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">()</span></div>

                

<div class="viewcode-block" id="pattern_stabilizer.text_report">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer.text_report">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">text_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_patterns</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">patterns_dss</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">class_vars</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">accuracies</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">rule_bases</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
                    <span class="n">rule_cutoff</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a text report for pattern stability.</span>

<span class="sd">        :param class_patterns: dict[list]. The dictionary with the unique patterns for each class.</span>
<span class="sd">        :param patterns_dss: dict[list]. The dictionary with the dominance score of each pattern for each class.</span>
<span class="sd">        :param class_vars: dict[list]. The dictionary with the number of times each variable is used in the rule base for each class.</span>
<span class="sd">        :param accuracies: list. The list with the accuracies of the generated solutions.</span>
<span class="sd">        :param rule_bases: list. The list with the generated rule bases.</span>
<span class="sd">        :param rule_cutoff: int. The number of rules to show in the report.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">consequents_names</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes_names</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pattern stability report for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="si">}</span><span class="s1"> generated solutions&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average accuracy: </span><span class="si">%.2f</span><span class="s1">\pm</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">accuracies</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-------------&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">class_patterns</span><span class="p">)):</span>
            <span class="n">class_pattern_ix</span> <span class="o">=</span> <span class="n">class_patterns</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
            <span class="n">rules_array_format</span> <span class="o">=</span> <span class="p">[</span><span class="n">str_rule_as_list</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">class_pattern_ix</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
            <span class="n">patterns_dss_ix</span> <span class="o">=</span> <span class="n">patterns_dss</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
            <span class="n">class_vars_ix</span> <span class="o">=</span> <span class="n">class_vars</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Class </span><span class="si">{</span><span class="n">consequents_names</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Number of unique patterns: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">class_pattern_ix</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">jx</span><span class="p">,</span> <span class="n">rule</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">class_pattern_ix</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">if</span> <span class="n">jx</span> <span class="o">&lt;</span> <span class="n">rule_cutoff</span><span class="p">:</span>
                    <span class="n">rule_print_format</span> <span class="o">=</span> <span class="n">rl</span><span class="o">.</span><span class="n">generate_rule_string</span><span class="p">(</span><span class="n">rules_array_format</span><span class="p">[</span><span class="n">jx</span><span class="p">],</span> <span class="n">rule_bases</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span><span class="o">.</span><span class="n">antecedents</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pattern </span><span class="si">{</span><span class="n">rule_print_format</span><span class="si">}</span><span class="s1"> appears in %.2f percent of the trials with a Dominance Score of </span><span class="si">{</span><span class="n">patterns_dss_ix</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="p">)]</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">float</span><span class="p">(</span><span class="n">class_pattern_ix</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">rule</span><span class="p">)]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">var_reports</span><span class="p">(</span><span class="n">class_vars_ix</span><span class="p">,</span> <span class="n">rule_bases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">antecedents</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">()</span></div>

    

<div class="viewcode-block" id="pattern_stabilizer.stability_report">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer.stability_report">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">stability_report</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_gen</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">pop_size</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">test_size</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="mf">0.33</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a stability report for pattern stabilization.</span>

<span class="sd">        :param n: int. The number of solutions to generate.</span>
<span class="sd">        :return text_report: str. The text report for pattern stability.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">class_patterns</span><span class="p">,</span> <span class="n">patterns_dss</span><span class="p">,</span> <span class="n">class_vars</span><span class="p">,</span> <span class="n">accuracies</span><span class="p">,</span> <span class="n">rule_bases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_patterns_scores</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n_gen</span><span class="o">=</span><span class="n">n_gen</span><span class="p">,</span> <span class="n">pop_size</span><span class="o">=</span><span class="n">pop_size</span><span class="p">,</span><span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_patterns</span> <span class="o">=</span> <span class="n">class_patterns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">patterns_dss</span> <span class="o">=</span> <span class="n">patterns_dss</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_vars</span> <span class="o">=</span> <span class="n">class_vars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">accuracies</span> <span class="o">=</span> <span class="n">accuracies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span> <span class="o">=</span> <span class="n">rule_bases</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">text_report</span><span class="p">(</span><span class="n">class_patterns</span><span class="p">,</span> <span class="n">patterns_dss</span><span class="p">,</span> <span class="n">class_vars</span><span class="p">,</span> <span class="n">accuracies</span><span class="p">,</span> <span class="n">rule_bases</span><span class="p">)</span></div>

    

<div class="viewcode-block" id="pattern_stabilizer.pie_chart_basic">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer.pie_chart_basic">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pie_chart_basic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_ix</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">class_ix</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a pie chart for the variable usage in the rule bases.</span>
<span class="sd">        </span>
<span class="sd">        :param var_ix: int. The index of the variable to analyze.</span>
<span class="sd">        :param class_ix: int. The index of the class to analyze.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">antecedents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">class_ix</span><span class="p">]</span><span class="o">.</span><span class="n">antecedents</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sizes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_vars</span><span class="p">[</span><span class="n">class_ix</span><span class="p">][</span><span class="n">var_ix</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">var</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">antecedents</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

        <span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


    
<div class="viewcode-block" id="pattern_stabilizer.pie_chart_var">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer.pie_chart_var">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pie_chart_var</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_ix</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a pie chart for the variable usage in the rule bases.</span>

<span class="sd">        :param var_ix: int. The index of the variable to analyze.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">antecedents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">antecedents</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_colormap</span><span class="p">(</span><span class="n">antecedents</span><span class="p">)</span>

        <span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Variable </span><span class="si">{</span><span class="n">antecedents</span><span class="p">[</span><span class="n">var_ix</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> usage in the rulebases&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">class_ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">sizes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_vars</span><span class="p">[</span><span class="n">class_ix</span><span class="p">][</span><span class="n">var_ix</span><span class="p">]</span>
            <span class="n">ax1</span><span class="p">[</span><span class="n">class_ix</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_names</span><span class="p">[</span><span class="n">class_ix</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">var</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">antecedents</span><span class="p">[</span><span class="n">var_ix</span><span class="p">][</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="n">sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        
            <span class="n">ax1</span><span class="p">[</span><span class="n">class_ix</span><span class="p">]</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>
            <span class="n">ax1</span><span class="p">[</span><span class="n">class_ix</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>


    
<div class="viewcode-block" id="pattern_stabilizer.pie_chart_class">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer.pie_chart_class">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">pie_chart_class</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_ix</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">var_list</span><span class="p">:</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a pie chart for the variable usage in the rule bases.</span>

<span class="sd">        :param class_ix: int. The index of the class to analyze.</span>
<span class="sd">        :param var_list: list[int]. The list of variables to analyze. If None (default) all variables will be analyzed.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">antecedents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">antecedents</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_colormap</span><span class="p">(</span><span class="n">antecedents</span><span class="p">)</span>
        
        <span class="n">fig1</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">fig1</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Class </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">classes_names</span><span class="p">[</span><span class="n">class_ix</span><span class="p">]</span><span class="si">}</span><span class="s1"> variable usage in the rulebases&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">var_ix</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rule_bases</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">var_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">var_ix</span> <span class="ow">in</span> <span class="n">var_list</span><span class="p">)</span> <span class="ow">or</span> <span class="n">var_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">sizes</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">var</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">class_vars</span><span class="p">[</span><span class="n">class_ix</span><span class="p">][</span><span class="n">var_ix</span><span class="p">]</span>
                <span class="n">ax1</span><span class="p">[</span><span class="n">var_ix</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Variable </span><span class="si">{</span><span class="n">antecedents</span><span class="p">[</span><span class="n">var_ix</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">var</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">var</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">antecedents</span><span class="p">[</span><span class="n">var_ix</span><span class="p">][</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                        <span class="n">sizes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            
                <span class="n">ax1</span><span class="p">[</span><span class="n">var_ix</span><span class="p">]</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">sizes</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>
                <span class="n">ax1</span><span class="p">[</span><span class="n">var_ix</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>



<div class="viewcode-block" id="pattern_stabilizer.gen_colormap">
<a class="viewcode-back" href="../../function_resume/pattern_stability.html#ex_fuzzy.pattern_stability.pattern_stabilizer.gen_colormap">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">gen_colormap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">antecedents</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Generates a colormap for the special cases of 2 and 3 linguistic variables.</span>

<span class="sd">        :param antecedents: list. The list of antecedents.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">largest_vl_ix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_linguist_variables</span><span class="p">)</span>
        <span class="n">largest_vl_n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_linguist_variables</span><span class="p">[</span><span class="n">largest_vl_ix</span><span class="p">]</span>

        <span class="c1"># Note: red and yellow has been softened to avoid eye strain, that&#39;s why there are colors specified with hexadecimals</span>
        <span class="k">if</span> <span class="n">largest_vl_n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="c1"># There is the special case of low/high</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span> <span class="n">label</span><span class="p">:</span> <span class="n">color</span>  <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">antecedent</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">antecedent</span> <span class="ow">in</span> <span class="n">antecedents</span><span class="p">[</span><span class="n">largest_vl_ix</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;#FA8072&#39;</span><span class="p">,</span> <span class="s1">&#39;Green&#39;</span><span class="p">])}</span> 
        <span class="k">elif</span> <span class="n">largest_vl_n</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span> <span class="c1"># There is the special case of low/medium/high</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span> <span class="n">label</span><span class="p">:</span> <span class="n">color</span>  <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">antecedent</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">antecedent</span> <span class="ow">in</span> <span class="n">antecedents</span><span class="p">[</span><span class="n">largest_vl_ix</span><span class="p">]],</span> <span class="p">[</span><span class="s1">&#39;#FA8072&#39;</span><span class="p">,</span> <span class="s1">&#39;#EEE8AA&#39;</span><span class="p">,</span> <span class="s1">&#39;Green&#39;</span><span class="p">])}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colormap_custom</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">colormaps</span><span class="p">[</span><span class="s1">&#39;coolwarm&#39;</span><span class="p">](</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">len</span><span class="p">(</span><span class="n">largest_vl_n</span><span class="p">)]))</span>
            
            <span class="n">colors</span> <span class="o">=</span> <span class="p">{</span> <span class="n">label</span><span class="p">:</span> <span class="n">color</span>  <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="n">antecedent</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">antecedent</span> <span class="ow">in</span> <span class="n">antecedents</span><span class="p">],</span> <span class="n">colormap_custom</span><span class="p">)}</span>
        <span class="k">return</span> <span class="n">colors</span></div>
</div>

            
</pre></div>

                </article>
              
              
              
              
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
       Copyright 2023-2025, Javier Fumanal Idocin.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>